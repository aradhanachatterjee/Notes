<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <title>Notes - Week 3</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Week 3</h1>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="lecture-3.1-sql-examples" class="title-slide slide level1 center">
<h1>Lecture 3.1: SQL Examples</h1>

</section>
<section id="select-distinct" class="slide level2">
<h2>Select distinct</h2>
<ul>
<li>From the <code>classroom</code> relation, find the names of buildings in which every individual classroom has capacity less than 100 (removing the duplicates).</li>
</ul>
<div id="cell-8" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="4">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">building</th>
<th data-quarto-table-cell-role="th">room_number</th>
<th data-quarto-table-cell-role="th">capacity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Packard</td>
<td>101</td>
<td>500</td>
</tr>
<tr class="even">
<td>Painter</td>
<td>514</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Taylor</td>
<td>3128</td>
<td>70</td>
</tr>
<tr class="even">
<td>Watson</td>
<td>100</td>
<td>30</td>
</tr>
<tr class="odd">
<td>Watson</td>
<td>120</td>
<td>50</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Query:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> building</span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> classroom</span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> capacity <span class="op">&lt;</span> <span class="dv">100</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-11" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="12">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">building</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Painter</td>
</tr>
<tr class="even">
<td>Taylor</td>
</tr>
<tr class="odd">
<td>Watson</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="select-all" class="slide level2">
<h2>Select all</h2>
<ul>
<li>From the <code>classroom</code> relation, find the names of buildings in which every individual classroom has a capacity of less than 100 (without removing the duplicates).</li>
</ul>
<div id="cell-13" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display" data-execution_count="20">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">building</th>
<th data-quarto-table-cell-role="th">room_number</th>
<th data-quarto-table-cell-role="th">capacity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Packard</td>
<td>101</td>
<td>500</td>
</tr>
<tr class="even">
<td>Painter</td>
<td>514</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Taylor</td>
<td>3128</td>
<td>70</td>
</tr>
<tr class="even">
<td>Watson</td>
<td>100</td>
<td>30</td>
</tr>
<tr class="odd">
<td>Watson</td>
<td>120</td>
<td>50</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Query:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">ALL</span> building</span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> classroom C</span>
<span id="cb2-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> capacity <span class="op">&lt;</span> <span class="dv">100</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-16" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="16">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">building</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Painter</td>
</tr>
<tr class="even">
<td>Taylor</td>
</tr>
<tr class="odd">
<td>Watson</td>
</tr>
<tr class="even">
<td>Watson</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Note that duplicate retention is the default and hence it is a common practice to skip <code>all</code> immediately after <code>select</code>.</li>
</ul>
</section>
<section id="cartesian-product" class="slide level2">
<h2>Cartesian product</h2>
<div id="cell-20" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display" data-execution_count="8">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">building</th>
<th data-quarto-table-cell-role="th">budget</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Biology</td>
<td>Watson</td>
<td>90000</td>
</tr>
<tr class="even">
<td>Comp. Sci.</td>
<td>Taylor</td>
<td>100000</td>
</tr>
<tr class="odd">
<td>Elec. Eng.</td>
<td>Taylor</td>
<td>85000</td>
</tr>
<tr class="even">
<td>Finance</td>
<td>Painter</td>
<td>120000</td>
</tr>
<tr class="odd">
<td>History</td>
<td>Painter</td>
<td>50000</td>
</tr>
<tr class="even">
<td>Music</td>
<td>Packard</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>Physics</td>
<td>Watson</td>
<td>70000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display" data-execution_count="10">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">tot_cred</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>00128</td>
<td>Zhang</td>
<td>Comp. Sci.</td>
<td>102</td>
</tr>
<tr class="even">
<td>12345</td>
<td>Shankar</td>
<td>Comp. Sci.</td>
<td>32</td>
</tr>
<tr class="odd">
<td>19991</td>
<td>Brandt</td>
<td>History</td>
<td>80</td>
</tr>
<tr class="even">
<td>23121</td>
<td>Chavez</td>
<td>Finance</td>
<td>110</td>
</tr>
<tr class="odd">
<td>44553</td>
<td>Peltier</td>
<td>Physics</td>
<td>56</td>
</tr>
<tr class="even">
<td>45678</td>
<td>Levy</td>
<td>Physics</td>
<td>46</td>
</tr>
<tr class="odd">
<td>54321</td>
<td>Williams</td>
<td>Comp. Sci.</td>
<td>54</td>
</tr>
<tr class="even">
<td>55739</td>
<td>Sanchez</td>
<td>Music</td>
<td>38</td>
</tr>
<tr class="odd">
<td>70557</td>
<td>Snow</td>
<td>Physics</td>
<td>0</td>
</tr>
<tr class="even">
<td>76543</td>
<td>Brown</td>
<td>Comp. Sci.</td>
<td>58</td>
</tr>
<tr class="odd">
<td>76653</td>
<td>Aoi</td>
<td>Elec. Eng.</td>
<td>60</td>
</tr>
<tr class="even">
<td>98765</td>
<td>Bourikas</td>
<td>Elec. Eng.</td>
<td>98</td>
</tr>
<tr class="odd">
<td>98988</td>
<td>Tanaka</td>
<td>Biology</td>
<td>120</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Find the list of all students of departments which have a budget &lt; $0.1million</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> name, budget</span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> student, department</span>
<span id="cb3-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> student.dept_name <span class="op">=</span> department.dept_name <span class="kw">AND</span> budget <span class="op">&lt;</span> <span class="dv">100000</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-26" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="12">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">budget</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Brandt</td>
<td>50000</td>
</tr>
<tr class="even">
<td>Peltier</td>
<td>70000</td>
</tr>
<tr class="odd">
<td>Levy</td>
<td>70000</td>
</tr>
<tr class="even">
<td>Sanchez</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>Snow</td>
<td>70000</td>
</tr>
<tr class="even">
<td>Aoi</td>
<td>85000</td>
</tr>
<tr class="odd">
<td>Bourikas</td>
<td>85000</td>
</tr>
<tr class="even">
<td>Tanaka</td>
<td>90000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>The above query first generates every possible student-department pair, which is the Cartesian product of the <code>student</code> and <code>department</code> relations. Then, it filters out all the rows with student.dept_name = department.dept_name <strong>and</strong> department.budget &lt; 100000.</li>
<li>The common attribute <code>dept_name</code> in the resulting table is renamed using the relation name - student.dept_name and department.dept_name.</li>
</ul>
</section>
<section id="rename-as-operation" class="slide level2">
<h2>Rename AS Operation</h2>
<ul>
<li>The same query above can be framed by renaming the tables as follows:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> S.name <span class="kw">AS</span> studentname, budget <span class="kw">AS</span> deptbudget</span>
<span id="cb4-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> student <span class="kw">AS</span> S, department <span class="kw">AS</span> D</span>
<span id="cb4-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> S.dept_name <span class="op">=</span> D.dept_name <span class="kw">AND</span> budget <span class="op">&lt;</span> <span class="dv">100000</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-31" class="cell" data-execution_count="14">
<div class="cell-output cell-output-display" data-execution_count="14">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">studentname</th>
<th data-quarto-table-cell-role="th">deptbudget</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Brandt</td>
<td>50000</td>
</tr>
<tr class="even">
<td>Peltier</td>
<td>70000</td>
</tr>
<tr class="odd">
<td>Levy</td>
<td>70000</td>
</tr>
<tr class="even">
<td>Sanchez</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>Snow</td>
<td>70000</td>
</tr>
<tr class="even">
<td>Aoi</td>
<td>85000</td>
</tr>
<tr class="odd">
<td>Bourikas</td>
<td>85000</td>
</tr>
<tr class="even">
<td>Tanaka</td>
<td>90000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>The above query renames the relations <code>student</code> and <code>department</code> as <code>S</code> and <code>D</code> respectively</li>
<li>It also displays the attribute <code>name</code> as <code>StudentName</code> and <code>budget</code> as <code>DeptBudget</code></li>
<li>Note that the budget attribute does not have any prefix because it occurs only in the department relation.</li>
</ul>
</section>
<section id="where-and-and-or" class="slide level2">
<h2>Where: AND and OR</h2>
<ul>
<li>From the <code>instructor</code> and <code>department</code> relations, find out the names of all instructors whose department is Finance <em>or</em> whose department is in any of the following buildings: Watson, Taylor.</li>
</ul>
<div id="cell-35" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="16">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10101</td>
<td>Srinivasan</td>
<td>Comp. Sci.</td>
<td>65000</td>
</tr>
<tr class="even">
<td>12121</td>
<td>Wu</td>
<td>Finance</td>
<td>90000</td>
</tr>
<tr class="odd">
<td>15151</td>
<td>Mozart</td>
<td>Music</td>
<td>40000</td>
</tr>
<tr class="even">
<td>22222</td>
<td>Einstein</td>
<td>Physics</td>
<td>95000</td>
</tr>
<tr class="odd">
<td>32343</td>
<td>El Said</td>
<td>History</td>
<td>60000</td>
</tr>
<tr class="even">
<td>33456</td>
<td>Gold</td>
<td>Physics</td>
<td>87000</td>
</tr>
<tr class="odd">
<td>45565</td>
<td>Katz</td>
<td>Comp. Sci.</td>
<td>75000</td>
</tr>
<tr class="even">
<td>58583</td>
<td>Califieri</td>
<td>History</td>
<td>62000</td>
</tr>
<tr class="odd">
<td>76543</td>
<td>Singh</td>
<td>Finance</td>
<td>80000</td>
</tr>
<tr class="even">
<td>76766</td>
<td>Crick</td>
<td>Biology</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>83821</td>
<td>Brandt</td>
<td>Comp. Sci.</td>
<td>92000</td>
</tr>
<tr class="even">
<td>98345</td>
<td>Kim</td>
<td>Elec. Eng.</td>
<td>80000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="17">
<div class="cell-output cell-output-display" data-execution_count="17">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">building</th>
<th data-quarto-table-cell-role="th">budget</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Biology</td>
<td>Watson</td>
<td>90000</td>
</tr>
<tr class="even">
<td>Comp. Sci.</td>
<td>Taylor</td>
<td>100000</td>
</tr>
<tr class="odd">
<td>Elec. Eng.</td>
<td>Taylor</td>
<td>85000</td>
</tr>
<tr class="even">
<td>Finance</td>
<td>Painter</td>
<td>120000</td>
</tr>
<tr class="odd">
<td>History</td>
<td>Painter</td>
<td>50000</td>
</tr>
<tr class="even">
<td>Music</td>
<td>Packard</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>Physics</td>
<td>Watson</td>
<td>70000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> name</span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> instructor I, department D</span>
<span id="cb5-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> I.dept_name <span class="op">=</span> D.dept_name</span>
<span id="cb5-4"><a aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> (I.dept_name <span class="op">=</span> <span class="st">'Finance'</span> <span class="kw">OR</span> building <span class="kw">IN</span> (<span class="st">'Watson'</span>, <span class="st">'Taylor'</span>));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-39" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display" data-execution_count="19">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Srinivasan</td>
</tr>
<tr class="even">
<td>Wu</td>
</tr>
<tr class="odd">
<td>Einstein</td>
</tr>
<tr class="even">
<td>Gold</td>
</tr>
<tr class="odd">
<td>Katz</td>
</tr>
<tr class="even">
<td>Singh</td>
</tr>
<tr class="odd">
<td>Crick</td>
</tr>
<tr class="even">
<td>Brandt</td>
</tr>
<tr class="odd">
<td>Kim</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="string-operations" class="slide level2">
<h2>String Operations</h2>
<div id="cell-42" class="cell" data-execution_count="22">
<div class="cell-output cell-output-display" data-execution_count="22">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-101</td>
<td>Intro. to Biology</td>
<td>Biology</td>
<td>4</td>
</tr>
<tr class="even">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
</tr>
<tr class="odd">
<td>BIO-399</td>
<td>Computational Biology</td>
<td>Biology</td>
<td>3</td>
</tr>
<tr class="even">
<td>CS-101</td>
<td>Intro. to Computer Science</td>
<td>Comp. Sci.</td>
<td>4</td>
</tr>
<tr class="odd">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
</tr>
<tr class="even">
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
</tr>
<tr class="odd">
<td>CS-319</td>
<td>Image Processing</td>
<td>Comp. Sci.</td>
<td>3</td>
</tr>
<tr class="even">
<td>CS-347</td>
<td>Database System Concepts</td>
<td>Comp. Sci.</td>
<td>3</td>
</tr>
<tr class="odd">
<td>EE-181</td>
<td>Intro. to Digital Systems</td>
<td>Elec. Eng.</td>
<td>3</td>
</tr>
<tr class="even">
<td>FIN-201</td>
<td>Investment Banking</td>
<td>Finance</td>
<td>3</td>
</tr>
<tr class="odd">
<td>HIS-351</td>
<td>World History</td>
<td>History</td>
<td>3</td>
</tr>
<tr class="even">
<td>MU-199</td>
<td>Music Video Production</td>
<td>Music</td>
<td>3</td>
</tr>
<tr class="odd">
<td>PHY-101</td>
<td>Physical Principles</td>
<td>Physics</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the course <code>relation</code>, find the titles of all courses whose <code>course_id</code> has three alphabets indicating the department.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> title</span>
<span id="cb6-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> course</span>
<span id="cb6-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> course_id <span class="kw">LIKE</span> <span class="st">'___-%'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-46" class="cell" data-execution_count="27">
<div class="cell-output cell-output-display" data-execution_count="27">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intro. to Biology</td>
</tr>
<tr class="even">
<td>Genetics</td>
</tr>
<tr class="odd">
<td>Computational Biology</td>
</tr>
<tr class="even">
<td>Investment Banking</td>
</tr>
<tr class="odd">
<td>World History</td>
</tr>
<tr class="even">
<td>Physical Principles</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>The <code>course_id</code> of each department either has 2 or 3 alphabets in the beginning, followed by a hypher and then followed by 3 digits. The above query returns the names of all courses whose <code>course_id</code> has 3 alphabets in the beginning.</li>
</ul>
</section>
<section id="order-by" class="slide level2">
<h2>Order By</h2>
<div id="cell-49" class="cell" data-execution_count="23">
<div class="cell-output cell-output-display" data-execution_count="23">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">tot_cred</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>00128</td>
<td>Zhang</td>
<td>Comp. Sci.</td>
<td>102</td>
</tr>
<tr class="even">
<td>12345</td>
<td>Shankar</td>
<td>Comp. Sci.</td>
<td>32</td>
</tr>
<tr class="odd">
<td>19991</td>
<td>Brandt</td>
<td>History</td>
<td>80</td>
</tr>
<tr class="even">
<td>23121</td>
<td>Chavez</td>
<td>Finance</td>
<td>110</td>
</tr>
<tr class="odd">
<td>44553</td>
<td>Peltier</td>
<td>Physics</td>
<td>56</td>
</tr>
<tr class="even">
<td>45678</td>
<td>Levy</td>
<td>Physics</td>
<td>46</td>
</tr>
<tr class="odd">
<td>54321</td>
<td>Williams</td>
<td>Comp. Sci.</td>
<td>54</td>
</tr>
<tr class="even">
<td>55739</td>
<td>Sanchez</td>
<td>Music</td>
<td>38</td>
</tr>
<tr class="odd">
<td>70557</td>
<td>Snow</td>
<td>Physics</td>
<td>0</td>
</tr>
<tr class="even">
<td>76543</td>
<td>Brown</td>
<td>Comp. Sci.</td>
<td>58</td>
</tr>
<tr class="odd">
<td>76653</td>
<td>Aoi</td>
<td>Elec. Eng.</td>
<td>60</td>
</tr>
<tr class="even">
<td>98765</td>
<td>Bourikas</td>
<td>Elec. Eng.</td>
<td>98</td>
</tr>
<tr class="odd">
<td>98988</td>
<td>Tanaka</td>
<td>Biology</td>
<td>120</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the student relation in the table, obtain the list of all students in alphabetic order of departments and within each department, in decreasing order of total credits.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> name, dept_name, tot_cred</span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> student</span>
<span id="cb7-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> dept_name <span class="kw">ASC</span>, tot_cred <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-53" class="cell" data-execution_count="29">
<div class="cell-output cell-output-display" data-execution_count="29">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">tot_cred</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tanaka</td>
<td>Biology</td>
<td>120</td>
</tr>
<tr class="even">
<td>Zhang</td>
<td>Comp. Sci.</td>
<td>102</td>
</tr>
<tr class="odd">
<td>Brown</td>
<td>Comp. Sci.</td>
<td>58</td>
</tr>
<tr class="even">
<td>Williams</td>
<td>Comp. Sci.</td>
<td>54</td>
</tr>
<tr class="odd">
<td>Shankar</td>
<td>Comp. Sci.</td>
<td>32</td>
</tr>
<tr class="even">
<td>Bourikas</td>
<td>Elec. Eng.</td>
<td>98</td>
</tr>
<tr class="odd">
<td>Aoi</td>
<td>Elec. Eng.</td>
<td>60</td>
</tr>
<tr class="even">
<td>Chavez</td>
<td>Finance</td>
<td>110</td>
</tr>
<tr class="odd">
<td>Brandt</td>
<td>History</td>
<td>80</td>
</tr>
<tr class="even">
<td>Sanchez</td>
<td>Music</td>
<td>38</td>
</tr>
<tr class="odd">
<td>Peltier</td>
<td>Physics</td>
<td>56</td>
</tr>
<tr class="even">
<td>Levy</td>
<td>Physics</td>
<td>46</td>
</tr>
<tr class="odd">
<td>Snow</td>
<td>Physics</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>The list is first sorted in alphabetic order of dept name.</li>
<li>Within each dept, it is sorted in decreasing order of total credits.</li>
</ul>
</section>
<section id="in-operator" class="slide level2">
<h2>In Operator</h2>
<div id="cell-57" class="cell" data-execution_count="25">
<div class="cell-output cell-output-display" data-execution_count="25">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">sec_id</th>
<th data-quarto-table-cell-role="th">semester</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10101</td>
<td>CS-101</td>
<td>1</td>
<td>Fall</td>
<td>2017</td>
</tr>
<tr class="even">
<td>10101</td>
<td>CS-315</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
</tr>
<tr class="odd">
<td>10101</td>
<td>CS-347</td>
<td>1</td>
<td>Fall</td>
<td>2017</td>
</tr>
<tr class="even">
<td>12121</td>
<td>FIN-201</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
</tr>
<tr class="odd">
<td>15151</td>
<td>MU-199</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
</tr>
<tr class="even">
<td>22222</td>
<td>PHY-101</td>
<td>1</td>
<td>Fall</td>
<td>2017</td>
</tr>
<tr class="odd">
<td>32343</td>
<td>HIS-351</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
</tr>
<tr class="even">
<td>45565</td>
<td>CS-101</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
</tr>
<tr class="odd">
<td>45565</td>
<td>CS-319</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
</tr>
<tr class="even">
<td>76766</td>
<td>BIO-101</td>
<td>1</td>
<td>Summer</td>
<td>2017</td>
</tr>
<tr class="odd">
<td>76766</td>
<td>BIO-301</td>
<td>1</td>
<td>Summer</td>
<td>2018</td>
</tr>
<tr class="even">
<td>83821</td>
<td>CS-190</td>
<td>1</td>
<td>Spring</td>
<td>2017</td>
</tr>
<tr class="odd">
<td>83821</td>
<td>CS-190</td>
<td>2</td>
<td>Spring</td>
<td>2017</td>
</tr>
<tr class="even">
<td>83821</td>
<td>CS-319</td>
<td>2</td>
<td>Spring</td>
<td>2018</td>
</tr>
<tr class="odd">
<td>98345</td>
<td>EE-181</td>
<td>1</td>
<td>Spring</td>
<td>2017</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the <code>teaches</code> relation, find the IDs of all courses taught in the Fall or Spring of 2018.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> course_id</span>
<span id="cb8-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> teaches</span>
<span id="cb8-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> semester <span class="kw">IN</span> (<span class="st">'Fall'</span>, <span class="st">'Spring'</span>) <span class="kw">AND</span> <span class="dt">year</span> <span class="op">=</span> <span class="dv">2018</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-61" class="cell" data-execution_count="31">
<div class="cell-output cell-output-display" data-execution_count="31">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CS-315</td>
</tr>
<tr class="even">
<td>FIN-201</td>
</tr>
<tr class="odd">
<td>MU-199</td>
</tr>
<tr class="even">
<td>HIS-351</td>
</tr>
<tr class="odd">
<td>CS-101</td>
</tr>
<tr class="even">
<td>CS-319</td>
</tr>
<tr class="odd">
<td>CS-319</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Note: We can use <code>distinct</code> to remove duplicates.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> course_id</span>
<span id="cb9-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> teaches</span>
<span id="cb9-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> semester <span class="kw">IN</span> (<span class="st">'Fall'</span>, <span class="st">'Spring'</span>) <span class="kw">AND</span> <span class="dt">year</span> <span class="op">=</span> <span class="dv">2018</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-65" class="cell" data-execution_count="33">
<div class="cell-output cell-output-display" data-execution_count="33">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CS-315</td>
</tr>
<tr class="even">
<td>FIN-201</td>
</tr>
<tr class="odd">
<td>MU-199</td>
</tr>
<tr class="even">
<td>HIS-351</td>
</tr>
<tr class="odd">
<td>CS-101</td>
</tr>
<tr class="even">
<td>CS-319</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section>
<section>
<section id="set-operations-union" class="title-slide slide level1 center">
<h1>Set Operations: union</h1>
<ul>
<li>For the same question as above, find the solution using the <code>union</code> operator.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> course_id</span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> teaches</span>
<span id="cb10-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> semester<span class="op">=</span><span class="st">'Fall'</span> <span class="kw">AND</span> <span class="dt">year</span><span class="op">=</span><span class="dv">2018</span></span>
<span id="cb10-4"><a aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span></span>
<span id="cb10-5"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> course_id</span>
<span id="cb10-6"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> teaches</span>
<span id="cb10-7"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> semester<span class="op">=</span><span class="st">'Spring'</span> <span class="kw">AND</span> <span class="dt">year</span><span class="op">=</span><span class="dv">2018</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-69" class="cell" data-execution_count="35">
<div class="cell-output cell-output-display" data-execution_count="35">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CS-101</td>
</tr>
<tr class="even">
<td>CS-315</td>
</tr>
<tr class="odd">
<td>CS-319</td>
</tr>
<tr class="even">
<td>FIN-201</td>
</tr>
<tr class="odd">
<td>HIS-351</td>
</tr>
<tr class="even">
<td>MU-199</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Note that <code>union</code> removes all duplicates. If we use <code>union all</code> instead of <code>union</code>, we get the same set of tuples but with duplicates.</li>
</ul>
</section>
<section id="set-operations-2-intersect" class="slide level2">
<h2>Set Operations (2): intersect</h2>
<div id="cell-72" class="cell" data-execution_count="36">
<div class="cell-output cell-output-display" data-execution_count="36">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10101</td>
<td>Srinivasan</td>
<td>Comp. Sci.</td>
<td>65000</td>
</tr>
<tr class="even">
<td>12121</td>
<td>Wu</td>
<td>Finance</td>
<td>90000</td>
</tr>
<tr class="odd">
<td>15151</td>
<td>Mozart</td>
<td>Music</td>
<td>40000</td>
</tr>
<tr class="even">
<td>22222</td>
<td>Einstein</td>
<td>Physics</td>
<td>95000</td>
</tr>
<tr class="odd">
<td>32343</td>
<td>El Said</td>
<td>History</td>
<td>60000</td>
</tr>
<tr class="even">
<td>33456</td>
<td>Gold</td>
<td>Physics</td>
<td>87000</td>
</tr>
<tr class="odd">
<td>45565</td>
<td>Katz</td>
<td>Comp. Sci.</td>
<td>75000</td>
</tr>
<tr class="even">
<td>58583</td>
<td>Califieri</td>
<td>History</td>
<td>62000</td>
</tr>
<tr class="odd">
<td>76543</td>
<td>Singh</td>
<td>Finance</td>
<td>80000</td>
</tr>
<tr class="even">
<td>76766</td>
<td>Crick</td>
<td>Biology</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>83821</td>
<td>Brandt</td>
<td>Comp. Sci.</td>
<td>92000</td>
</tr>
<tr class="even">
<td>98345</td>
<td>Kim</td>
<td>Elec. Eng.</td>
<td>80000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the <code>instructor</code> relation, find the names of all instructors who taught in either the Computer Science department or the Finance department and whose salary is &lt; 80000.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> name</span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> instructor</span>
<span id="cb11-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> dept_name <span class="kw">IN</span> (<span class="st">'Comp. Sci.'</span>, <span class="st">'Finance'</span>)</span>
<span id="cb11-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">INTERSECT</span></span>
<span id="cb11-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> name</span>
<span id="cb11-6"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> instructor</span>
<span id="cb11-7"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> salary <span class="op">&lt;</span> <span class="dv">80000</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-76" class="cell" data-execution_count="38">
<div class="cell-output cell-output-display" data-execution_count="38">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Katz</td>
</tr>
<tr class="even">
<td>Srinivasan</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> name</span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> instructor</span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dept_name <span class="kw">IN</span> (<span class="st">'Comp. Sci.'</span>, <span class="st">'Finance'</span>) <span class="kw">AND</span> salary <span class="op">&lt;</span> <span class="dv">80000</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-79" class="cell" data-execution_count="40">
<div class="cell-output cell-output-display" data-execution_count="40">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Srinivasan</td>
</tr>
<tr class="even">
<td>Katz</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="set-operations-3-except" class="slide level2">
<h2>Set Operations (3): except</h2>
<ul>
<li>From the <code>instructor</code> relation, find the names of all instructors who taught in the Computer Science department or the Finance department and whose salary is either &gt;= 90000 or &lt;= 70000.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> name</span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> instructor</span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> dept_name <span class="kw">IN</span> (<span class="st">'Comp. Sci.'</span>, <span class="st">'Finance'</span>)</span>
<span id="cb13-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">EXCEPT</span></span>
<span id="cb13-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> name</span>
<span id="cb13-6"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> instructor</span>
<span id="cb13-7"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> salary <span class="op">&lt;</span> <span class="dv">90000</span> <span class="kw">AND</span> salary <span class="op">&gt;</span> <span class="dv">70000</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-83" class="cell" data-execution_count="42">
<div class="cell-output cell-output-display" data-execution_count="42">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Brandt</td>
</tr>
<tr class="even">
<td>Srinivasan</td>
</tr>
<tr class="odd">
<td>Wu</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> name</span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> instructor</span>
<span id="cb14-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dept_name <span class="kw">IN</span> (<span class="st">'Comp. Sci.'</span>, <span class="st">'Finance'</span>) <span class="kw">AND</span> (salary <span class="op">&gt;=</span> <span class="dv">90000</span> <span class="kw">OR</span> salary <span class="op">&lt;=</span> <span class="dv">70000</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-86" class="cell" data-execution_count="44">
<div class="cell-output cell-output-display" data-execution_count="44">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Srinivasan</td>
</tr>
<tr class="even">
<td>Wu</td>
</tr>
<tr class="odd">
<td>Brandt</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="aggregate-functions-avg" class="slide level2">
<h2>Aggregate functions: avg</h2>
<div id="cell-88" class="cell" data-execution_count="45">
<div class="cell-output cell-output-display" data-execution_count="45">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">building</th>
<th data-quarto-table-cell-role="th">room_number</th>
<th data-quarto-table-cell-role="th">capacity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Packard</td>
<td>101</td>
<td>500</td>
</tr>
<tr class="even">
<td>Painter</td>
<td>514</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Taylor</td>
<td>3128</td>
<td>70</td>
</tr>
<tr class="even">
<td>Watson</td>
<td>100</td>
<td>30</td>
</tr>
<tr class="odd">
<td>Watson</td>
<td>120</td>
<td>50</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the <code>classroom</code> relation, find the names and the average capacity of each building whose average capacity is greater than 25.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> building, <span class="fu">AVG</span>(capacity)</span>
<span id="cb15-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> classroom</span>
<span id="cb15-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> building</span>
<span id="cb15-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">HAVING</span> <span class="fu">AVG</span>(capacity) <span class="op">&gt;</span> <span class="dv">25</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-92" class="cell" data-execution_count="49">
<div class="cell-output cell-output-display" data-execution_count="49">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">building</th>
<th data-quarto-table-cell-role="th">AVG(capacity)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Packard</td>
<td>500.0</td>
</tr>
<tr class="even">
<td>Taylor</td>
<td>70.0</td>
</tr>
<tr class="odd">
<td>Watson</td>
<td>40.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="aggregate-functions-2-min" class="slide level2">
<h2>Aggregate functions (2): min</h2>
<div id="cell-94" class="cell" data-execution_count="46">
<div class="cell-output cell-output-display" data-execution_count="46">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10101</td>
<td>Srinivasan</td>
<td>Comp. Sci.</td>
<td>65000</td>
</tr>
<tr class="even">
<td>12121</td>
<td>Wu</td>
<td>Finance</td>
<td>90000</td>
</tr>
<tr class="odd">
<td>15151</td>
<td>Mozart</td>
<td>Music</td>
<td>40000</td>
</tr>
<tr class="even">
<td>22222</td>
<td>Einstein</td>
<td>Physics</td>
<td>95000</td>
</tr>
<tr class="odd">
<td>32343</td>
<td>El Said</td>
<td>History</td>
<td>60000</td>
</tr>
<tr class="even">
<td>33456</td>
<td>Gold</td>
<td>Physics</td>
<td>87000</td>
</tr>
<tr class="odd">
<td>45565</td>
<td>Katz</td>
<td>Comp. Sci.</td>
<td>75000</td>
</tr>
<tr class="even">
<td>58583</td>
<td>Califieri</td>
<td>History</td>
<td>62000</td>
</tr>
<tr class="odd">
<td>76543</td>
<td>Singh</td>
<td>Finance</td>
<td>80000</td>
</tr>
<tr class="even">
<td>76766</td>
<td>Crick</td>
<td>Biology</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>83821</td>
<td>Brandt</td>
<td>Comp. Sci.</td>
<td>92000</td>
</tr>
<tr class="even">
<td>98345</td>
<td>Kim</td>
<td>Elec. Eng.</td>
<td>80000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the <code>instructor</code> relation, find the least salary drawn by any instructor among all the instructors.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">MIN</span>(salary) <span class="kw">AS</span> least_salary</span>
<span id="cb16-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> instructor;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-98" class="cell" data-execution_count="51">
<div class="cell-output cell-output-display" data-execution_count="51">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">least_salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>40000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="aggregate-functions-3-max" class="slide level2">
<h2>Aggregate functions (3): max</h2>
<div id="cell-100" class="cell" data-execution_count="47">
<div class="cell-output cell-output-display" data-execution_count="47">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">tot_cred</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>00128</td>
<td>Zhang</td>
<td>Comp. Sci.</td>
<td>102</td>
</tr>
<tr class="even">
<td>12345</td>
<td>Shankar</td>
<td>Comp. Sci.</td>
<td>32</td>
</tr>
<tr class="odd">
<td>19991</td>
<td>Brandt</td>
<td>History</td>
<td>80</td>
</tr>
<tr class="even">
<td>23121</td>
<td>Chavez</td>
<td>Finance</td>
<td>110</td>
</tr>
<tr class="odd">
<td>44553</td>
<td>Peltier</td>
<td>Physics</td>
<td>56</td>
</tr>
<tr class="even">
<td>45678</td>
<td>Levy</td>
<td>Physics</td>
<td>46</td>
</tr>
<tr class="odd">
<td>54321</td>
<td>Williams</td>
<td>Comp. Sci.</td>
<td>54</td>
</tr>
<tr class="even">
<td>55739</td>
<td>Sanchez</td>
<td>Music</td>
<td>38</td>
</tr>
<tr class="odd">
<td>70557</td>
<td>Snow</td>
<td>Physics</td>
<td>0</td>
</tr>
<tr class="even">
<td>76543</td>
<td>Brown</td>
<td>Comp. Sci.</td>
<td>58</td>
</tr>
<tr class="odd">
<td>76653</td>
<td>Aoi</td>
<td>Elec. Eng.</td>
<td>60</td>
</tr>
<tr class="even">
<td>98765</td>
<td>Bourikas</td>
<td>Elec. Eng.</td>
<td>98</td>
</tr>
<tr class="odd">
<td>98988</td>
<td>Tanaka</td>
<td>Biology</td>
<td>120</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the <code>student</code> relation, find the maximum credits obtained by any student among all the students.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">MAX</span>(tot_cred) <span class="kw">AS</span> max_credits</span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> student;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-104" class="cell" data-execution_count="53">
<div class="cell-output cell-output-display" data-execution_count="53">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">max_credits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>120</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="aggregate-functions-4-count" class="slide level2">
<h2>Aggregate functions (4): count</h2>
<div id="cell-107" class="cell" data-execution_count="55">
<div class="cell-output cell-output-display" data-execution_count="55">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">sec_id</th>
<th data-quarto-table-cell-role="th">semester</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">building</th>
<th data-quarto-table-cell-role="th">room_number</th>
<th data-quarto-table-cell-role="th">time_slot_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-101</td>
<td>1</td>
<td>Summer</td>
<td>2017</td>
<td>Painter</td>
<td>514</td>
<td>B</td>
</tr>
<tr class="even">
<td>BIO-301</td>
<td>1</td>
<td>Summer</td>
<td>2018</td>
<td>Painter</td>
<td>514</td>
<td>A</td>
</tr>
<tr class="odd">
<td>CS-101</td>
<td>1</td>
<td>Fall</td>
<td>2017</td>
<td>Packard</td>
<td>101</td>
<td>H</td>
</tr>
<tr class="even">
<td>CS-101</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
<td>Packard</td>
<td>101</td>
<td>F</td>
</tr>
<tr class="odd">
<td>CS-190</td>
<td>1</td>
<td>Spring</td>
<td>2017</td>
<td>Taylor</td>
<td>3128</td>
<td>E</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>2</td>
<td>Spring</td>
<td>2017</td>
<td>Taylor</td>
<td>3128</td>
<td>A</td>
</tr>
<tr class="odd">
<td>CS-315</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
<td>Watson</td>
<td>120</td>
<td>D</td>
</tr>
<tr class="even">
<td>CS-319</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
<td>Watson</td>
<td>100</td>
<td>B</td>
</tr>
<tr class="odd">
<td>CS-319</td>
<td>2</td>
<td>Spring</td>
<td>2018</td>
<td>Taylor</td>
<td>3128</td>
<td>C</td>
</tr>
<tr class="even">
<td>CS-347</td>
<td>1</td>
<td>Fall</td>
<td>2017</td>
<td>Taylor</td>
<td>3128</td>
<td>A</td>
</tr>
<tr class="odd">
<td>EE-181</td>
<td>1</td>
<td>Spring</td>
<td>2017</td>
<td>Taylor</td>
<td>3128</td>
<td>C</td>
</tr>
<tr class="even">
<td>FIN-201</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
<td>Packard</td>
<td>101</td>
<td>B</td>
</tr>
<tr class="odd">
<td>HIS-351</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
<td>Painter</td>
<td>514</td>
<td>C</td>
</tr>
<tr class="even">
<td>MU-199</td>
<td>1</td>
<td>Spring</td>
<td>2018</td>
<td>Packard</td>
<td>101</td>
<td>D</td>
</tr>
<tr class="odd">
<td>PHY-101</td>
<td>1</td>
<td>Fall</td>
<td>2017</td>
<td>Watson</td>
<td>100</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the <code>section</code> relation, find the number of courses run in each building.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> building, <span class="fu">COUNT</span>(course_id) <span class="kw">AS</span> course_count</span>
<span id="cb18-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> section</span>
<span id="cb18-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> building;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-111" class="cell" data-execution_count="58">
<div class="cell-output cell-output-display" data-execution_count="58">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">building</th>
<th data-quarto-table-cell-role="th">course_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Packard</td>
<td>4</td>
</tr>
<tr class="even">
<td>Painter</td>
<td>3</td>
</tr>
<tr class="odd">
<td>Taylor</td>
<td>5</td>
</tr>
<tr class="even">
<td>Watson</td>
<td>3</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="aggregate-functions-5-sum" class="slide level2">
<h2>Aggregate functions (5): sum</h2>
<div id="cell-113" class="cell" data-execution_count="56">
<div class="cell-output cell-output-display" data-execution_count="56">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-101</td>
<td>Intro. to Biology</td>
<td>Biology</td>
<td>4</td>
</tr>
<tr class="even">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
</tr>
<tr class="odd">
<td>BIO-399</td>
<td>Computational Biology</td>
<td>Biology</td>
<td>3</td>
</tr>
<tr class="even">
<td>CS-101</td>
<td>Intro. to Computer Science</td>
<td>Comp. Sci.</td>
<td>4</td>
</tr>
<tr class="odd">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
</tr>
<tr class="even">
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
</tr>
<tr class="odd">
<td>CS-319</td>
<td>Image Processing</td>
<td>Comp. Sci.</td>
<td>3</td>
</tr>
<tr class="even">
<td>CS-347</td>
<td>Database System Concepts</td>
<td>Comp. Sci.</td>
<td>3</td>
</tr>
<tr class="odd">
<td>EE-181</td>
<td>Intro. to Digital Systems</td>
<td>Elec. Eng.</td>
<td>3</td>
</tr>
<tr class="even">
<td>FIN-201</td>
<td>Investment Banking</td>
<td>Finance</td>
<td>3</td>
</tr>
<tr class="odd">
<td>HIS-351</td>
<td>World History</td>
<td>History</td>
<td>3</td>
</tr>
<tr class="even">
<td>MU-199</td>
<td>Music Video Production</td>
<td>Music</td>
<td>3</td>
</tr>
<tr class="odd">
<td>PHY-101</td>
<td>Physical Principles</td>
<td>Physics</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the <code>course</code> relation, find the total credits offered by each department.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> dept_name, <span class="fu">SUM</span>(credits) <span class="kw">AS</span> sum_credits</span>
<span id="cb19-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> course</span>
<span id="cb19-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> dept_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-117" class="cell" data-execution_count="60">
<div class="cell-output cell-output-display" data-execution_count="60">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">sum_credits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Biology</td>
<td>11</td>
</tr>
<tr class="even">
<td>Comp. Sci.</td>
<td>17</td>
</tr>
<tr class="odd">
<td>Elec. Eng.</td>
<td>3</td>
</tr>
<tr class="even">
<td>Finance</td>
<td>3</td>
</tr>
<tr class="odd">
<td>History</td>
<td>3</td>
</tr>
<tr class="even">
<td>Music</td>
<td>3</td>
</tr>
<tr class="odd">
<td>Physics</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section>
<section>
<section id="lecture-3.2-intermediate-sql1" class="title-slide slide level1 center">
<h1>Lecture 3.2: Intermediate SQL/1</h1>

</section>
<section id="nested-subqueries" class="slide level2">
<h2>Nested Subqueries</h2>
<ul>
<li>SQL provides a mechanism for nesting of subqueries</li>
<li>A <strong>subquery</strong> is a <strong>select-from-where</strong> expression that is nested within another query</li>
<li>The nesting can be done in the following SQL query <span class="math display">\[ \text{select } A_1, A_2, ..., A_n \]</span> <span class="math display">\[ \text{from } r_1, r_2, ..., r_m \]</span> <span class="math display">\[ \text{where } P \]</span> as follows:
<ul>
<li><p><span class="math inline">\(A_i\)</span> can be a subquery that generates a single value</p></li>
<li><p><span class="math inline">\(r_i\)</span> can be replaced by any valid subquery</p></li>
<li><p><span class="math inline">\(P\)</span> can be replaced with an expressionm of the form:</p>
<p><span class="math inline">\(B \text{ &lt;operation&gt;}\)</span> (subquery)</p>
<p>where <span class="math inline">\(B\)</span> is an attribute and <span class="math inline">\(\text{&lt;operation&gt;}\)</span> to be defined later.</p></li>
</ul></li>
</ul>
</section>
<section id="subqueries-in-the-where-clause" class="slide level2">
<h2>Subqueries in the Where Clause</h2>
<ul>
<li>Typical use of subqueries is to perform tests:
<ul>
<li>For set membership</li>
<li>For set comparisons</li>
<li>For set cardinality</li>
</ul></li>
</ul>
</section>
<section id="set-membership" class="slide level2">
<h2>Set Membership</h2>
<ul>
<li>Find courses offered in Fall 2009 and in Spring 2010 (<strong>intersect</strong> example)</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="kw">distinct</span> course_id</span>
<span id="cb20-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> section</span>
<span id="cb20-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> semester <span class="op">=</span> <span class="st">'Fall'</span> <span class="kw">and</span> <span class="dt">year</span> <span class="op">=</span> <span class="dv">2017</span> <span class="kw">and</span></span>
<span id="cb20-4"><a aria-hidden="true" tabindex="-1"></a>    course_id <span class="kw">in</span> (<span class="kw">select</span> course_id</span>
<span id="cb20-5"><a aria-hidden="true" tabindex="-1"></a>                <span class="kw">from</span> section</span>
<span id="cb20-6"><a aria-hidden="true" tabindex="-1"></a>                <span class="kw">where</span> semester <span class="op">=</span> <span class="st">'Spring'</span> <span class="kw">and</span> <span class="dt">year</span> <span class="op">=</span> <span class="dv">2018</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-123" class="cell" data-execution_count="62">
<div class="cell-output cell-output-display" data-execution_count="62">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CS-347</td>
</tr>
<tr class="even">
<td>PHY-101</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="set-membership-2" class="slide level2">
<h2>Set Membership (2)</h2>
<ul>
<li>Find the total number of (distinct) students who have taken course sections taught by instructor with ID ‘10101’</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="kw">distinct</span> <span class="kw">ID</span>)</span>
<span id="cb21-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> takes</span>
<span id="cb21-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> (course_id, sec_id, semester, <span class="dt">year</span>) <span class="kw">in</span></span>
<span id="cb21-4"><a aria-hidden="true" tabindex="-1"></a>    (<span class="kw">select</span> course_id, sec_id, semester, <span class="dt">year</span></span>
<span id="cb21-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> teaches</span>
<span id="cb21-6"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> teaches.<span class="kw">ID</span> <span class="op">=</span> <span class="st">'10101'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-126" class="cell" data-execution_count="64">
<div class="cell-output cell-output-display" data-execution_count="64">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">count(distinct ID)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-127" class="cell" data-execution_count="29">
<div class="cell-output cell-output-display" data-execution_count="29">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">count(distinct ID)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="set-comparison---some-clause" class="slide level2">
<h2>Set Comparison - “some” Clause</h2>
<ul>
<li>Find the names of instructors with salary greater than that of some (at least one) instructor in the Biology department</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="kw">distinct</span> T.name</span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> instructor T, instructor S</span>
<span id="cb22-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> T.salary <span class="op">&gt;</span> S.salary <span class="kw">and</span> S.dept_name <span class="op">=</span> <span class="st">'Biology'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Same query using <strong>some</strong> clause</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> name</span>
<span id="cb23-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> instructor</span>
<span id="cb23-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> salary <span class="op">&gt;</span> <span class="kw">some</span> (<span class="kw">select</span> salary</span>
<span id="cb23-4"><a aria-hidden="true" tabindex="-1"></a>                        <span class="kw">from</span> instructor</span>
<span id="cb23-5"><a aria-hidden="true" tabindex="-1"></a>                        <span class="kw">where</span> dept_name <span class="op">=</span> <span class="st">'Biology'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="definition-of-some-clause" class="slide level2">
<h2>Definition of “some” Clause</h2>
<ul>
<li>F <span class="math inline">\(\text{&lt;comp&gt;}\)</span> <strong>some</strong> <span class="math inline">\(r \Leftrightarrow \exists t \in r\)</span> such that (F <span class="math inline">\(\text{&lt;comp&gt;}\)</span> t) where <span class="math inline">\(\text{&lt;comp&gt;}\)</span> can be: <span class="math inline">\(&lt;\)</span>, <span class="math inline">\(\leq\)</span>, <span class="math inline">\(&gt;\)</span>, <span class="math inline">\(\geq\)</span>, <span class="math inline">\(=\)</span>, <span class="math inline">\(\neq\)</span></li>
<li><strong>some</strong> represents existential quantification</li>
</ul>
<p>(5 &lt; <strong>some</strong> {0, 5, 6}) = True</p>
<p>(5 &lt; <strong>some</strong> {0, 5}) = False</p>
<p>(5 = <strong>some</strong> {0, 5}) = True</p>
<p>(5 <span class="math inline">\(\neq\)</span> <strong>some</strong> {0, 5}) = False</p>
<p>(= <strong>some</strong>) <span class="math inline">\(\equiv\)</span> <strong>in</strong></p>
<p>However, (<span class="math inline">\(\neq\)</span> <strong>some</strong>) <span class="math inline">\(\equiv\)</span> <strong>not in</strong></p>
</section>
<section id="set-comparison---all-clause" class="slide level2">
<h2>Set Comparison - “all” Clause</h2>
<ul>
<li>Find the names of all instructors with salary greater than that of all instructors in the Biology department</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> name</span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> instructor</span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> salary <span class="op">&gt;</span> <span class="kw">all</span> (<span class="kw">select</span> salary</span>
<span id="cb24-4"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">from</span> instructor</span>
<span id="cb24-5"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">where</span> dept_name <span class="op">=</span> <span class="st">'Biology'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="definition-of-all-clause" class="slide level2">
<h2>Definition of “all” Clause</h2>
<ul>
<li>F <span class="math inline">\(\text{&lt;comp&gt;}\)</span> <strong>all</strong> <span class="math inline">\(r \Leftrightarrow \forall t \in r\)</span> such that (F <span class="math inline">\(\text{&lt;comp&gt;}\)</span> t) where <span class="math inline">\(\text{&lt;comp&gt;}\)</span> can be: <span class="math inline">\(&lt;\)</span>, <span class="math inline">\(\leq\)</span>, <span class="math inline">\(&gt;\)</span>, <span class="math inline">\(\geq\)</span>, <span class="math inline">\(=\)</span>, <span class="math inline">\(\neq\)</span></li>
<li><strong>all</strong> represents universal quantification</li>
</ul>
<p>(5 &lt; <strong>all</strong> {0, 5, 6}) = False</p>
<p>(5 &lt; <strong>all</strong> {6, 10}) = True</p>
<p>(5 = <strong>all</strong> {0, 5}) = False</p>
<p>(5 <span class="math inline">\(\neq\)</span> <strong>all</strong> {4, 6}) = True</p>
<p>(<span class="math inline">\(\neq\)</span> <strong>all</strong>) <span class="math inline">\(\equiv\)</span> <strong>not in</strong></p>
<p>However, (<span class="math inline">\(=\)</span> <strong>all</strong>) !<span class="math inline">\(\equiv\)</span> <strong>in</strong></p>
</section>
<section id="test-for-empty-relations-exists" class="slide level2">
<h2>Test for Empty Relations: “exists”</h2>
<ul>
<li>The <strong>exists</strong> constucrt returns the value <strong>true</strong> if the argument subquery is non-empty
<ul>
<li><strong>exists</strong> $r r $</li>
<li><strong>not exists</strong> $r r = $</li>
</ul></li>
</ul>
</section>
<section id="use-of-exists-clause" class="slide level2">
<h2>Use of “exists” clause</h2>
<ul>
<li>Yet another way of specifying the query “Find all courses taught in both the Fall 2009 semester and in the Spring 2010 semester”</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb25-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> course_id</span>
<span id="cb25-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> section <span class="kw">as</span> S</span>
<span id="cb25-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> semester <span class="op">=</span> <span class="st">'Fall'</span> <span class="kw">and</span> <span class="dt">year</span> <span class="op">=</span> <span class="dv">2009</span> <span class="kw">and</span></span>
<span id="cb25-4"><a aria-hidden="true" tabindex="-1"></a><span class="kw">exists</span> (<span class="kw">select</span> <span class="op">*</span></span>
<span id="cb25-5"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">from</span> section <span class="kw">as</span> T</span>
<span id="cb25-6"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">where</span> semester <span class="op">=</span> <span class="st">'Spring'</span> <span class="kw">and</span> <span class="dt">year</span> <span class="op">=</span> <span class="dv">2010</span> <span class="kw">and</span></span>
<span id="cb25-7"><a aria-hidden="true" tabindex="-1"></a>        S.course_id <span class="op">=</span> T.course_id);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Correlation name</strong> - variable S in the outer query</li>
<li><strong>Correlated subquery</strong> - subquery that references the correlation name (the inner query)</li>
</ul>
</section>
<section id="use-of-not-exists-clause" class="slide level2">
<h2>Use of “not exists” clause</h2>
<ul>
<li>Find all students who have taken all courses offered in the Biology department.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="kw">distinct</span> S.<span class="kw">ID</span>, S.name</span>
<span id="cb26-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> student <span class="kw">as</span> S</span>
<span id="cb26-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> <span class="kw">not</span> <span class="kw">exists</span> ((<span class="kw">select</span> course_id</span>
<span id="cb26-4"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">from</span> course</span>
<span id="cb26-5"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">where</span> dept_name <span class="op">=</span> <span class="st">'Biology'</span>)</span>
<span id="cb26-6"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">except</span></span>
<span id="cb26-7"><a aria-hidden="true" tabindex="-1"></a>                    (<span class="kw">select</span> T.course_id</span>
<span id="cb26-8"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">from</span> takes <span class="kw">as</span> T</span>
<span id="cb26-9"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">where</span> S.<span class="kw">ID</span> <span class="op">=</span> T.<span class="kw">ID</span>));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>First nested query lists all courses offered in Biology</p></li>
<li><p>Second nested query lists all courses a particular student took</p></li>
<li><p>Note: <span class="math inline">\(X-Y = \emptyset \Leftrightarrow X \subseteq Y\)</span></p></li>
<li><p>Note: Cannot write this query using <span class="math inline">\(=\)</span> <strong>all</strong> and its variants</p></li>
</ul>
</section>
<section id="test-for-absence-of-duplicate-tuples-unique" class="slide level2">
<h2>Test for Absence of Duplicate Tuples: “unique”</h2>
<ul>
<li>The <strong>unique</strong> construct tests whether a subquery has any duplicate tuples in its result</li>
<li>The <strong>unique</strong> construct evaluates to <strong>true</strong> if the subquery result has no duplicate tuples</li>
<li>Find all courses that were offered at most once in 2009</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb27-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> T.course_id</span>
<span id="cb27-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> course <span class="kw">as</span> T</span>
<span id="cb27-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> <span class="kw">unique</span> (<span class="kw">select</span> R.course_id</span>
<span id="cb27-4"><a aria-hidden="true" tabindex="-1"></a>              <span class="kw">from</span> section <span class="kw">as</span> R</span>
<span id="cb27-5"><a aria-hidden="true" tabindex="-1"></a>              <span class="kw">where</span> R.course_id <span class="op">=</span> T.course_id</span>
<span id="cb27-6"><a aria-hidden="true" tabindex="-1"></a>              <span class="kw">and</span> R.<span class="dt">year</span> <span class="op">=</span> <span class="dv">2009</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="subqueries-in-the-from-clause" class="slide level2">
<h2>Subqueries in the From Clause</h2>
<ul>
<li>SQL allows a subquery expression to be used in the <strong>from</strong> clause</li>
<li>Find the average instructors’ salaries of those departments where the average salary is greater than $42,000</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> dept_name, avg_salary</span>
<span id="cb28-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> (<span class="kw">select</span> dept_name, <span class="fu">avg</span>(salary) <span class="kw">as</span> avg_salary</span>
<span id="cb28-3"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">from</span> instructor</span>
<span id="cb28-4"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">group</span> <span class="kw">by</span> dept_name)</span>
<span id="cb28-5"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> avg_salary <span class="op">&gt;</span> <span class="dv">42000</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Note that we do not need to use the <strong>having</strong> clause</li>
<li>Another way to write the same query is:</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> dept_name, avg_salary</span>
<span id="cb29-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> (<span class="kw">select</span> dept_name, <span class="fu">avg</span>(salary)</span>
<span id="cb29-3"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">from</span> instructor</span>
<span id="cb29-4"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">group</span> <span class="kw">by</span> dept_name) <span class="kw">as</span> dept_avg (dept_name, avg_salary)</span>
<span id="cb29-5"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> avg_salary <span class="op">&gt;</span> <span class="dv">42000</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="with-clause" class="slide level2">
<h2>With Clause</h2>
<ul>
<li>The <strong>with</strong> clause provides a way of defining a temporary relation whose definition is available only to the query in which the with clause occurs</li>
<li>Find all departments with the maximum budget</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb30-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> max_budget(<span class="fu">value</span>) <span class="kw">as</span></span>
<span id="cb30-2"><a aria-hidden="true" tabindex="-1"></a>    (<span class="kw">select</span> <span class="fu">max</span>(budget)</span>
<span id="cb30-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> department)</span>
<span id="cb30-4"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> department.dept_name</span>
<span id="cb30-5"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> department, max_budget</span>
<span id="cb30-6"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> department.budget <span class="op">=</span> max_budget.<span class="fu">value</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="complex-queries-using-with-clause" class="slide level2">
<h2>Complex Queries using With Clause</h2>
<ul>
<li>Find all departments where the total salary is greater than the average of the total salary at all departments</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb31-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> dept_total(dept_name, <span class="fu">value</span>) <span class="kw">as</span></span>
<span id="cb31-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> dept_name, <span class="fu">sum</span>(salary)</span>
<span id="cb31-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> instructor</span>
<span id="cb31-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> dept_name,</span>
<span id="cb31-5"><a aria-hidden="true" tabindex="-1"></a>dept_total_avg(<span class="fu">value</span>) <span class="kw">as</span></span>
<span id="cb31-6"><a aria-hidden="true" tabindex="-1"></a>    (<span class="kw">select</span> <span class="fu">avg</span>(<span class="fu">value</span>)</span>
<span id="cb31-7"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> dept_total)</span>
<span id="cb31-8"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> dept_name</span>
<span id="cb31-9"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> dept_total, dept_total_avg</span>
<span id="cb31-10"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> dept_total.<span class="fu">value</span> <span class="op">&gt;</span> dept_total_avg.<span class="fu">value</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="scalar-subquery" class="slide level2">
<h2>Scalar Subquery</h2>
<ul>
<li>A <strong>scalar subquery</strong> is a subquery that returns a single value</li>
<li>List all departments along with the number of instructors in each department</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb32-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> dept_name,</span>
<span id="cb32-2"><a aria-hidden="true" tabindex="-1"></a>    (<span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>)</span>
<span id="cb32-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> instructor</span>
<span id="cb32-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> instructor.dept_name <span class="op">=</span> department.dept_name)</span>
<span id="cb32-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">as</span> num_instructors</span>
<span id="cb32-6"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> department;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Runtime error if the subquery returns more than one result tuple</li>
</ul>
</section>
<section id="modification-of-the-database" class="slide level2">
<h2>Modification of the Database</h2>
<ul>
<li>Deletion of tuples from a given relation</li>
<li>Insertion of new tuples into a given relation</li>
<li>Updating of values in some tuples in a given relation</li>
</ul>
</section>
<section id="deletion" class="slide level2">
<h2>Deletion</h2>
<ul>
<li><p>Delete all instructors</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">delete</span> <span class="kw">from</span> instructor;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Delete all instructors from the Finance department</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb34-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">delete</span> <span class="kw">from</span> instructor</span>
<span id="cb34-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> dept_name <span class="op">=</span> <span class="st">'Finance'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Delete all tuples in the instructor relation for those instructors associated with a department located in the Watson building</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb35-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">delete</span> <span class="kw">from</span> instructor</span>
<span id="cb35-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> dept_name <span class="kw">in</span> (<span class="kw">select</span> dept_name</span>
<span id="cb35-3"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">from</span> department</span>
<span id="cb35-4"><a aria-hidden="true" tabindex="-1"></a>                    <span class="kw">where</span> building <span class="op">=</span> <span class="st">'Watson'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Delete all instructors whose salary is less than the average of all instructors’ salaries</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb36-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">delete</span> <span class="kw">from</span> instructor</span>
<span id="cb36-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> salary <span class="op">&lt;</span> (<span class="kw">select</span> <span class="fu">avg</span>(salary)</span>
<span id="cb36-3"><a aria-hidden="true" tabindex="-1"></a>                <span class="kw">from</span> instructor);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>Problem</strong>: as we delete tuples, the average salary changes</p></li>
<li><p><strong>Solution</strong> used in SQL:</p>
<ul>
<li>First compute <strong>avg</strong>(salary) and find all tuples to be deleted</li>
<li>Next, delete all tuples found above (without recomputing <strong>avg</strong> or retesting the tuples)</li>
</ul></li>
</ul>
</section>
<section id="insertion" class="slide level2">
<h2>Insertion</h2>
<ul>
<li><p>Add a new typle to course</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb37-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> course</span>
<span id="cb37-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">values</span> (<span class="st">'CS-437'</span>, <span class="st">'Database Systems'</span>, <span class="st">'Comp. Sci.'</span>, <span class="dv">4</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>or equivalently</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb38-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> course (course_id, title, dept_name, credits)</span>
<span id="cb38-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">values</span> (<span class="st">'CS-437'</span>, <span class="st">'Database Systems'</span>, <span class="st">'Comp. Sci.'</span>, <span class="dv">4</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Add a new tuple to student with tot_creds set to null</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb39-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> student</span>
<span id="cb39-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">values</span> (<span class="st">'3003'</span>, <span class="st">'Green'</span>, <span class="st">'Finance'</span>, <span class="kw">null</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Add all instructors to the student relation with tot_creds set to 0</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb40-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> student</span>
<span id="cb40-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="kw">ID</span>, name, dept_name, <span class="dv">0</span></span>
<span id="cb40-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> instructor;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>The <strong>select-from-where</strong> statement is evaluated fully before any of its results are inserted into the relation</p></li>
<li><p>Otherwise queries like</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb41-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> table1 <span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> table1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>would result in an infinite loop</p></li>
</ul>
</section>
<section id="updates" class="slide level2">
<h2>Updates</h2>
<ul>
<li>Increase the salary of all instructors whose salary is over $100,00 by 3% and all others by 5%
<ul>
<li><p>With two <strong>update</strong> statements</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb42-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">update</span> instructor</span>
<span id="cb42-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> salary <span class="op">=</span> salary <span class="op">*</span> <span class="fl">1.03</span></span>
<span id="cb42-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> salary <span class="op">&gt;</span> <span class="dv">100000</span>;</span>
<span id="cb42-4"><a aria-hidden="true" tabindex="-1"></a><span class="kw">update</span> instructor</span>
<span id="cb42-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> salary <span class="op">=</span> salary <span class="op">*</span> <span class="fl">1.05</span></span>
<span id="cb42-6"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> salary <span class="op">&lt;=</span> <span class="dv">100000</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
<li>The order is important</li>
<li>Can be done better using the <strong>case</strong> statement</li>
</ul>
</section>
<section id="case-statement-for-conditional-updates" class="slide level2">
<h2>Case Statement for Conditional Updates</h2>
<ul>
<li><p>Same query as above using the <strong>case</strong> statement</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb43-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">update</span> instructor</span>
<span id="cb43-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> salary <span class="op">=</span> <span class="cf">case</span></span>
<span id="cb43-3"><a aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> salary <span class="op">&lt;=</span> <span class="dv">100000</span></span>
<span id="cb43-4"><a aria-hidden="true" tabindex="-1"></a>                <span class="cf">then</span> salary <span class="op">*</span> <span class="fl">1.05</span></span>
<span id="cb43-5"><a aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> salary <span class="op">*</span> <span class="fl">1.03</span></span>
<span id="cb43-6"><a aria-hidden="true" tabindex="-1"></a>                <span class="cf">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="updates-with-scalar-subqueries" class="slide level2">
<h2>Updates with Scalar Subqueries</h2>
<ul>
<li><p>Recompute and update tot_creds value for all students</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb44-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">update</span> student</span>
<span id="cb44-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> tot_creds <span class="op">=</span> (<span class="kw">select</span> <span class="fu">sum</span>(credits)</span>
<span id="cb44-3"><a aria-hidden="true" tabindex="-1"></a>                <span class="kw">from</span> takes, course</span>
<span id="cb44-4"><a aria-hidden="true" tabindex="-1"></a>                <span class="kw">where</span> takes.course_id <span class="op">=</span> course.course_id <span class="kw">and</span></span>
<span id="cb44-5"><a aria-hidden="true" tabindex="-1"></a>                S.<span class="kw">ID</span> <span class="op">=</span> takes.<span class="kw">ID</span> <span class="kw">and</span></span>
<span id="cb44-6"><a aria-hidden="true" tabindex="-1"></a>                takes.grade <span class="op">&lt;&gt;</span> <span class="st">'F'</span> <span class="kw">and</span></span>
<span id="cb44-7"><a aria-hidden="true" tabindex="-1"></a>                takes.grade <span class="kw">is</span> <span class="kw">not</span> <span class="kw">null</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Set tot_creds to null for all students who have not taken any courses</p></li>
<li><p>Instead of <strong>sum</strong>(credits), use:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb45-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span></span>
<span id="cb45-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">when</span> <span class="fu">sum</span>(credits) <span class="kw">is</span> <span class="kw">not</span> <span class="kw">null</span> <span class="cf">then</span> <span class="fu">sum</span>(credits)</span>
<span id="cb45-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb45-4"><a aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section></section>
<section>
<section id="lecture-3.3-intermediate-sql2" class="title-slide slide level1 center">
<h1>Lecture 3.3: Intermediate SQL/2</h1>

</section>
<section id="join-relations" class="slide level2">
<h2>Join Relations</h2>
<ul>
<li><strong>Join operations</strong> take two relations and return as result another relation</li>
<li>A join operation is a Cartesian product which requires that tuples in the two relations match (under some condition)</li>
<li>It also specifies the attributes that are present in the result of the join</li>
<li>The join operations are typically used as subquery expressions in the <strong>from</strong> clause</li>
</ul>
</section>
<section id="types-of-joins-between-relations" class="slide level2">
<h2>Types of Joins between Relations</h2>
<ul>
<li>Cross join</li>
<li>Inner join
<ul>
<li>Equi-join
<ul>
<li>Natural join</li>
</ul></li>
</ul></li>
<li>Outer join
<ul>
<li>Left outer join</li>
<li>Right outer join</li>
<li>Full outer join</li>
</ul></li>
<li>Self-join</li>
</ul>
</section>
<section id="cross-join" class="slide level2">
<h2>Cross Join</h2>
<ul>
<li>CROSS JOIN returns the Cartesian product of rows from tables in the join
<ul>
<li><p>Explicit</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb46-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span></span>
<span id="cb46-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> employee <span class="kw">cross</span> <span class="kw">join</span> department;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Implicit</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb47-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span></span>
<span id="cb47-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> employee, department;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
</ul>
</section>
<section id="join-operations---example" class="slide level2">
<h2>Join Operations - Example</h2>
<ul>
<li>Relation course</li>
</ul>
<div id="cell-157" class="cell" data-execution_count="31">
<div class="cell-output cell-output-display" data-execution_count="31">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
</tr>
<tr class="odd">
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Relation prereq</li>
</ul>
<div id="cell-160" class="cell" data-execution_count="35">
<div class="cell-output cell-output-display" data-execution_count="35">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>CS-101</td>
</tr>
<tr class="odd">
<td>CS-347</td>
<td>CS-101</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Observe that
<ul>
<li>prereq information is missing for course CS-315, and</li>
<li>course information is missing for CS-347</li>
</ul></li>
</ul>
</section>
<section id="inner-join" class="slide level2">
<h2>Inner Join</h2>
<ul>
<li>course <strong>inner join</strong> prereq</li>
</ul>
<div id="cell-164" class="cell" data-execution_count="41">
<div class="cell-output cell-output-display" data-execution_count="41">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">course_id_1</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-301</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-190</td>
<td>CS-101</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>If specified as <strong>natural</strong>, the join is on all attributes with the same name</li>
</ul>
<div id="cell-167" class="cell" data-execution_count="43">
<div class="cell-output cell-output-display" data-execution_count="43">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="outer-join" class="slide level2">
<h2>Outer Join</h2>
<ul>
<li>An extension of the join operation that avoids loss of information</li>
<li>Computes the join and then adds tuples from one relation that does not match tuples in the other relation to the result of the join</li>
<li>Uses <em>null</em> values, which is None in Python</li>
</ul>
</section>
<section id="left-outer-join" class="slide level2">
<h2>Left Outer Join</h2>
<ul>
<li>course <strong>left outer join</strong> prereq</li>
</ul>
<div id="cell-171" class="cell" data-execution_count="45">
<div class="cell-output cell-output-display" data-execution_count="45">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">course_id_1</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-301</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-190</td>
<td>CS-101</td>
</tr>
<tr class="odd">
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="right-outer-join" class="slide level2">
<h2>Right Outer Join</h2>
<ul>
<li>course <strong>right outer join</strong> prereq</li>
</ul>
<div id="cell-174" class="cell" data-execution_count="47">
<div class="cell-output cell-output-display" data-execution_count="47">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">course_id_1</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-301</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-190</td>
<td>CS-101</td>
</tr>
<tr class="odd">
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>CS-347</td>
<td>CS-101</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="joined-relations" class="slide level2">
<h2>Joined Relations</h2>
<ul>
<li><p>Join operations take two relations and return as a result another relation</p></li>
<li><p>These additional operations are typically used as subquery expressions in the <strong>from</strong> clause</p></li>
<li><p><em>Join condition</em> – defines which tuples in the two relations match, and what attributes are present in the result of the join</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb48-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">natural</span></span>
<span id="cb48-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">on</span> <span class="op">&lt;</span>predicate<span class="op">&gt;</span></span>
<span id="cb48-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> (attr1, attr2, <span class="op">..</span>.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><em>Join type</em> – defines how tuples in each relation that do not match any tuple in the other relation (based on the join condition) are treated</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb49-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">inner</span> <span class="kw">join</span></span>
<span id="cb49-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">left</span> <span class="kw">outer</span> <span class="kw">join</span></span>
<span id="cb49-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">right</span> <span class="kw">outer</span> <span class="kw">join</span></span>
<span id="cb49-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="full-outer-join" class="slide level2">
<h2>Full Outer Join</h2>
<ul>
<li>course <strong>full outer join</strong> prereq</li>
</ul>
<div id="cell-178" class="cell" data-execution_count="49">
<div class="cell-output cell-output-display" data-execution_count="49">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">course_id_1</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-301</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-190</td>
<td>CS-101</td>
</tr>
<tr class="odd">
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
<td>None</td>
<td>None</td>
</tr>
<tr class="even">
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>CS-347</td>
<td>CS-101</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="joining-relations---examples" class="slide level2">
<h2>Joining Relations - Examples</h2>
<ul>
<li><p>course <strong>inner join</strong> prereq <strong>on</strong></p>
<p>course.course_id = prereq.course_id</p></li>
</ul>
<div id="cell-181" class="cell" data-execution_count="51">
<div class="cell-output cell-output-display" data-execution_count="51">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">course_id_1</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-301</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-190</td>
<td>CS-101</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><p>What is the difference between the above (equi-join) and the natural join?</p></li>
<li><p>course <strong>left outer join</strong> prereq <strong>on</strong></p>
<p>course.course_id = prereq.course_id</p></li>
</ul>
<div id="cell-183" class="cell" data-execution_count="52">
<div class="cell-output cell-output-display" data-execution_count="52">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">course_id_1</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-301</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-190</td>
<td>CS-101</td>
</tr>
<tr class="odd">
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>course <strong>natural right outer join</strong> prereq</li>
</ul>
<div id="cell-186" class="cell" data-execution_count="54">
<div class="cell-output cell-output-display" data-execution_count="54">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
<tr class="odd">
<td>CS-347</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>CS-101</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>course <strong>full outer join</strong> prereq <strong>using</strong> (course_id)</li>
</ul>
<div id="cell-189" class="cell" data-execution_count="63">
<div class="cell-output cell-output-display" data-execution_count="63">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">course_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">dept_name</th>
<th data-quarto-table-cell-role="th">credits</th>
<th data-quarto-table-cell-role="th">prereq_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr class="even">
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
<tr class="odd">
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
<td>None</td>
</tr>
<tr class="even">
<td>CS-347</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>CS-101</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="views" class="slide level2">
<h2>Views</h2>
<ul>
<li><p>In some cases, it is not desirable for all users to see the entire logical model (that is, all the actual relations stored in the database.)</p></li>
<li><p>Consider a person who needs to know an instructors name and department, but not the salary. This person should see a relation described, in SQL, by:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb50-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="kw">ID</span>, name, dept_name</span>
<span id="cb50-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> instructor;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>A <strong>view</strong> provides a mechanism to hide certain data from the view of certain users</p></li>
<li><p>Any relation that is not of the conceptual model but is made visible to a user as a “virtual relation” is called a <strong>view</strong>.</p></li>
</ul>
</section>
<section id="view-definition" class="slide level2">
<h2>View Definition</h2>
<ul>
<li><p>A view is defined using the create view statement which has the form</p>
<pre><code>create view v as &lt; query expression &gt;</code></pre>
<p>where &lt; query expression &gt; is any legal SQL expression</p></li>
<li><p>The view name is represented by v</p></li>
<li><p>Once a view is defined, the view name can be used to refer to the virtual relation that the view generates</p></li>
<li><p>View definition is not the same as creating a new relation by evaluating the query expression</p>
<ul>
<li>Rather, a view definition causes the saving of an expression; the expression is substituted into queries using the view</li>
</ul></li>
</ul>
</section>
<section id="example-views" class="slide level2">
<h2>Example Views</h2>
<ul>
<li><p>A view of instructors without their salary</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb52-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">view</span> faculty <span class="kw">as</span></span>
<span id="cb52-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="kw">ID</span>, name, dept_name</span>
<span id="cb52-3"><a aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> instructor;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>A view of all instructors in the Biology department</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb53-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> name</span>
<span id="cb53-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> faculty</span>
<span id="cb53-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> dept_name <span class="op">=</span> <span class="st">'Biology'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Create a view of department salary totals</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb54-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">view</span> departments_total_salary(dept_name, total_salary) <span class="kw">as</span></span>
<span id="cb54-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> dept_name, <span class="fu">sum</span>(salary)</span>
<span id="cb54-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> instructor</span>
<span id="cb54-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> dept_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="views-defined-using-other-views" class="slide level2">
<h2>Views Defined Using Other Views</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb55-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">view</span> physics_fall_2009 <span class="kw">as</span></span>
<span id="cb55-2"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">select</span> course.course_id, sec_id, building, room_number</span>
<span id="cb55-3"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">from</span> course, section</span>
<span id="cb55-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">where</span> course.course_id <span class="op">=</span> section.course_id</span>
<span id="cb55-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">and</span> course.dept_name <span class="op">=</span> <span class="st">'Physics'</span></span>
<span id="cb55-6"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">and</span> section.semester <span class="op">=</span> <span class="st">'Fall'</span></span>
<span id="cb55-7"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">and</span> section.<span class="dt">year</span> <span class="op">=</span> <span class="dv">2009</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb56-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">view</span> physics_fall_2009_watson <span class="kw">as</span></span>
<span id="cb56-2"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">select</span> course_id, room_number</span>
<span id="cb56-3"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">from</span> physics_fall_2009</span>
<span id="cb56-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">where</span> building <span class="op">=</span> <span class="st">'Watson'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="view-expansion" class="slide level2">
<h2>View Expansion</h2>
<ul>
<li>Expand use of a view in a query/another view</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb57-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">view</span> physics_fall_2009_watson <span class="kw">as</span></span>
<span id="cb57-2"><a aria-hidden="true" tabindex="-1"></a>        (<span class="kw">select</span> course_id, room_number</span>
<span id="cb57-3"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">from</span> (<span class="kw">select</span> course.course_id, building, room_number</span>
<span id="cb57-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">from</span> course, section</span>
<span id="cb57-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">where</span> course.course_id <span class="op">=</span> section.course_id</span>
<span id="cb57-6"><a aria-hidden="true" tabindex="-1"></a>                <span class="kw">and</span> course.dept_name <span class="op">=</span> <span class="st">'Physics'</span></span>
<span id="cb57-7"><a aria-hidden="true" tabindex="-1"></a>                <span class="kw">and</span> section.semester <span class="op">=</span> <span class="st">'Fall'</span></span>
<span id="cb57-8"><a aria-hidden="true" tabindex="-1"></a>                <span class="kw">and</span> section.<span class="dt">year</span> <span class="op">=</span> <span class="dv">2009</span>)</span>
<span id="cb57-9"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">where</span> building <span class="op">=</span> <span class="st">'Watson'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>One view may be used in the expression defining another view</p></li>
<li><p>A view relation <span class="math inline">\(v_1\)</span> is said to <u><em>depend directly</em></u> on a view relation <span class="math inline">\(v_2\)</span> if <span class="math inline">\(v_2\)</span> is used in the expression defining <span class="math inline">\(v_1\)</span></p></li>
<li><p>A view relation <span class="math inline">\(v_1\)</span> is said to <u><em>depend on</em></u> view relation <span class="math inline">\(v_2\)</span> if either <span class="math inline">\(v_1\)</span> depends directly on <span class="math inline">\(v_2\)</span> or there is a path of dependencies from <span class="math inline">\(v_1\)</span> to <span class="math inline">\(v_2\)</span></p></li>
<li><p>A view relation v is said to be <u><em>recursive</em></u> if it depends on itself</p></li>
<li><p>A way to define the meaning of views defined in terms of other views</p></li>
<li><p>Let view <span class="math inline">\(v_1\)</span> be defined by an expression <span class="math inline">\(e_1\)</span> that may itself contain uses of view relations</p></li>
<li><p>View expansion of an expression repeats the following replacement step:</p>
<p><strong>repeat</strong></p>
<ul>
<li>Find any view relation <span class="math inline">\(v_i\)</span> in <span class="math inline">\(e_1\)</span></li>
<li>Replace the view relation <span class="math inline">\(v_i\)</span> by the expression defining <span class="math inline">\(v_i\)</span></li>
</ul>
<p><strong>until</strong> no more view relations are present in <span class="math inline">\(e_1\)</span></p></li>
<li><p>As long as the view definitions are not recursive, this loop will terminate</p></li>
</ul>
</section>
<section id="update-of-a-view" class="slide level2">
<h2>Update of a View</h2>
<ul>
<li><p>Add a new tuple to <em>faculty</em> view which we defined earlier</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb58-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">insert</span> <span class="kw">into</span> faculty <span class="kw">values</span> (’<span class="dv">30765</span>’, ’Green’, ’Music’);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>This insertion must be represented by the insertion of the tuple</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb59-1"><a aria-hidden="true" tabindex="-1"></a>  (’<span class="dv">30765</span>’, ’Green’, ’Music’, <span class="kw">null</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>into the instructor relation</p></li>
</ul>
</section>
<section id="some-updates-cannot-be-translated-uniquely" class="slide level2">
<h2>Some Updates cannot be Translated Uniquely</h2>
<ul>
<li><div class="sourceCode" id="cb60"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb60-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">view</span> instructor_info <span class="kw">as</span></span>
<span id="cb60-2"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">select</span> <span class="kw">ID</span>, name, building</span>
<span id="cb60-3"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">from</span> instructor, department</span>
<span id="cb60-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">where</span> instructor.dept_name <span class="op">=</span> department.dept_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><div class="sourceCode" id="cb61"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb61-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">insert</span> <span class="kw">into</span> instructor info <span class="kw">values</span> (<span class="st">'69987'</span>, <span class="st">'White'</span>, <span class="st">'Taylor'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>which department, if multiple departments in Taylor?</li>
<li>what if no department is in Taylor?</li>
</ul></li>
<li>Most SQL implementations allow updates only on simple views
<ul>
<li>The <strong>from</strong> clause has only one database relation</li>
<li>The <strong>select</strong> clause contains only attribute names of the relation, and does not have any expressions aggregates, or <strong>distinct</strong> specification</li>
<li>Any attribute not listed in the <strong>select</strong> clause can be set to null</li>
<li>The query does not have a <strong>group by</strong> or <strong>having</strong> clause</li>
</ul></li>
</ul>
</section>
<section id="and-some-not-at-all" class="slide level2">
<h2>And Some Not at All</h2>
<ul>
<li><div class="sourceCode" id="cb62"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb62-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">view</span> history_instructors <span class="kw">as</span></span>
<span id="cb62-2"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">select</span> <span class="op">*</span></span>
<span id="cb62-3"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">from</span> instructor</span>
<span id="cb62-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">where</span> dept_name <span class="op">=</span> <span class="st">'History'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>What happens if we insert (’25566’, ’Brown’, ’Biology’, 100000) into history_instructors?</li>
</ul>
</section>
<section id="materialized-views" class="slide level2">
<h2>Materialized Views</h2>
<ul>
<li><p><strong>Materializing a view</strong>: create a physical table containing all the tuples in the result of the query defining the view</p></li>
<li><p>If relations used in the query are updated, the materialized view result becomes out of date</p>
<ul>
<li>Need to <strong>maintain</strong> the view, by updating the view whenever the underlying relations are updated</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="lecture-3.4-intermediate-sql3" class="title-slide slide level1 center">
<h1>Lecture 3.4: Intermediate SQL/3</h1>

</section>
<section id="transactions" class="slide level2">
<h2>Transactions</h2>
<ul>
<li>Unit of work</li>
<li>Atomic transaction
<ul>
<li>either fully executed or rolled back as if it never happened</li>
</ul></li>
<li>Isolation from concurrent transactions</li>
<li>Transactions begin implicitly
<ul>
<li>End by <strong>commit work</strong> or <strong>rollback work</strong></li>
</ul></li>
<li>But default on most databases: each SQL statement commits automatically
<ul>
<li>Can turn off auto-commit for a session (for example, using API)</li>
<li>In SQL:1999, can use: <strong>begin atomic … end</strong>
<ul>
<li>Not supported on most databases</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="integrity-constraints" class="slide level2">
<h2>Integrity Constraints</h2>
<ul>
<li>Integrity constraints guard against accidental damage to the database, by ensuring that authorized changes to the database do not result in a loss of data consistency
<ul>
<li>A checking account must have a balance greater than Rs. 10,000.00</li>
<li>A salary of a bank employee must be at least Rs. 250.00 an hour</li>
<li>A customer must have a (non-null) phone number</li>
</ul></li>
</ul>
</section>
<section id="integrity-constraints-on-a-single-relation" class="slide level2">
<h2>Integrity Constraints on a Single Relation</h2>
<ul>
<li><strong>not null</strong></li>
<li><strong>primary key</strong></li>
<li><strong>unique</strong></li>
<li><strong>check</strong>(P), where P is a predicate</li>
</ul>
</section>
<section id="not-null-and-unique-constraints" class="slide level2">
<h2>Not Null and Unique Constraints</h2>
<ul>
<li><strong>not null</strong>
<ul>
<li><p>Declare name and budget to be not null</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb63-1"><a aria-hidden="true" tabindex="-1"></a>name <span class="dt">varchar</span>(<span class="dv">20</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb63-2"><a aria-hidden="true" tabindex="-1"></a>budget <span class="dt">numeric</span>(<span class="dv">12</span>, <span class="dv">2</span>) <span class="kw">not</span> <span class="kw">null</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
<li><strong>unique</strong> <span class="math inline">\((A_1, A_2, ..., A_m)\)</span>
<ul>
<li>The unique specification states that the attributes <span class="math inline">\(A_1, A_2, ..., A_m\)</span> form a candidate key</li>
<li>Candidate keys are permeitted to be null (unlike primary keys)</li>
</ul></li>
</ul>
</section>
<section id="the-check-clause" class="slide level2">
<h2>The check clause</h2>
<ul>
<li><p><strong>check</strong>(P), where P is a predicate</p></li>
<li><p>Ensure that semester is one of fall, winter, spring, or summer:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb64-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> section (</span>
<span id="cb64-2"><a aria-hidden="true" tabindex="-1"></a>  course_id <span class="dt">varchar</span>(<span class="dv">8</span>),</span>
<span id="cb64-3"><a aria-hidden="true" tabindex="-1"></a>  sec_id <span class="dt">varchar</span>(<span class="dv">8</span>),</span>
<span id="cb64-4"><a aria-hidden="true" tabindex="-1"></a>  semester <span class="dt">varchar</span>(<span class="dv">6</span>),</span>
<span id="cb64-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="dt">year</span> <span class="dt">numeric</span>(<span class="dv">4</span>, <span class="dv">0</span>),</span>
<span id="cb64-6"><a aria-hidden="true" tabindex="-1"></a>  building <span class="dt">varchar</span>(<span class="dv">15</span>),</span>
<span id="cb64-7"><a aria-hidden="true" tabindex="-1"></a>  room_number <span class="dt">varchar</span>(<span class="dv">7</span>),</span>
<span id="cb64-8"><a aria-hidden="true" tabindex="-1"></a>  time_slot_id <span class="dt">varchar</span>(<span class="dv">4</span>),</span>
<span id="cb64-9"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">primary</span> <span class="kw">key</span> (course_id, sec_id, semester, <span class="dt">year</span>),</span>
<span id="cb64-10"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">check</span> (semester <span class="kw">in</span> (<span class="st">'fall'</span>, <span class="st">'winter'</span>, <span class="st">'spring'</span>, <span class="st">'summer'</span>))</span>
<span id="cb64-11"><a aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="referential-integrity" class="slide level2">
<h2>Referential Integrity</h2>
<ul>
<li><p>Ensures that a value that appears in one relation for a given set of attributes also appears for a certain set of attributes in another relation</p></li>
<li><p>Example: If “Biology” is a department name appearing in one of the tuples in the instructor relation, then there exists a tuple in the department relation for “Biology”</p></li>
<li><p>Let A be a set of attributes. Let R and S be two relations that contain attributes A and where A is the primary key of S. A is said to be a <strong>foreign key</strong> of R if for any values of A appearing in R these values also appear in S</p></li>
</ul>
</section>
<section id="cascading-actions-in-referential-integrity" class="slide level2">
<h2>Cascading Actions in Referential Integrity</h2>
<ul>
<li><p>With cascading, you can define the actions that the Database Engine takes when a user tries to delete or update a key to which existing foreign keys point</p></li>
<li><div class="sourceCode" id="cb65"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb65-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">table</span> course (</span>
<span id="cb65-2"><a aria-hidden="true" tabindex="-1"></a>        course_id <span class="dt">char</span>(<span class="dv">5</span>) <span class="kw">primary</span> <span class="kw">key</span>,</span>
<span id="cb65-3"><a aria-hidden="true" tabindex="-1"></a>        title <span class="dt">varchar</span>(<span class="dv">20</span>),</span>
<span id="cb65-4"><a aria-hidden="true" tabindex="-1"></a>        dept_name <span class="dt">varchar</span>(<span class="dv">20</span>) <span class="kw">references</span> department</span>
<span id="cb65-5"><a aria-hidden="true" tabindex="-1"></a>    );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><div class="sourceCode" id="cb66"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb66-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">table</span> course (</span>
<span id="cb66-2"><a aria-hidden="true" tabindex="-1"></a>        <span class="op">..</span>.</span>
<span id="cb66-3"><a aria-hidden="true" tabindex="-1"></a>        dept_name <span class="dt">varchar</span>(<span class="dv">20</span>),</span>
<span id="cb66-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreign</span> <span class="kw">key</span> (dept_name) <span class="kw">references</span> department</span>
<span id="cb66-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">on</span> <span class="kw">delete</span> <span class="kw">cascade</span></span>
<span id="cb66-6"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">on</span> <span class="kw">update</span> <span class="kw">cascade</span>,</span>
<span id="cb66-7"><a aria-hidden="true" tabindex="-1"></a>        <span class="op">..</span>.</span>
<span id="cb66-8"><a aria-hidden="true" tabindex="-1"></a>    );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Alternative actions to cascade: <strong>no action</strong>, <strong>set null</strong>, <strong>set default</strong></p></li>
</ul>
</section>
<section id="integrity-constraint-violation-during-transactions" class="slide level2">
<h2>Integrity Constraint Violation During Transactions</h2>
<ul>
<li><div class="sourceCode" id="cb67"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb67-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">table</span> person (</span>
<span id="cb67-2"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">ID</span> <span class="dt">char</span>(<span class="dv">10</span>),</span>
<span id="cb67-3"><a aria-hidden="true" tabindex="-1"></a>        name <span class="dt">char</span>(<span class="dv">40</span>),</span>
<span id="cb67-4"><a aria-hidden="true" tabindex="-1"></a>        mother <span class="dt">char</span>(<span class="dv">10</span>),</span>
<span id="cb67-5"><a aria-hidden="true" tabindex="-1"></a>        father <span class="dt">char</span>(<span class="dv">10</span>),</span>
<span id="cb67-6"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">primary</span> <span class="kw">key</span> <span class="kw">ID</span>,</span>
<span id="cb67-7"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreign</span> <span class="kw">key</span> father <span class="kw">references</span> person,</span>
<span id="cb67-8"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreign</span> <span class="kw">key</span> mother <span class="kw">references</span> person)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>How to insert a tuple without causing constraint violation?
<ul>
<li>Insert father and mother of a person before inserting person</li>
<li>OR, Set father and mother to null initially, update after inserting all persons (not possible if father and mother attributes declared to be not null)</li>
<li>OR Defer constraint checking (will discuss later)</li>
</ul></li>
</ul>
</section>
<section id="built-in-data-types-in-sql" class="slide level2">
<h2>Built-in Data Types in SQL</h2>
<ul>
<li><strong>date</strong>: Dates, containing a (4 digit) year, month and date
<ul>
<li>Example: <strong>date</strong> ‘2005-7-27’</li>
</ul></li>
<li><strong>time</strong>: Time of day, in hours, minutes and seconds.
<ul>
<li>Example: <strong>time</strong> ‘09:00:30’ time ‘09:00:30.75’</li>
</ul></li>
<li><strong>timestamp</strong>: date plus time of day
<ul>
<li>Example: <strong>timestamp</strong> ‘2005-7-27 09:00:30.75’</li>
</ul></li>
<li><strong>interval</strong>: period of time
<ul>
<li>Example: <strong>interval</strong> ‘1’ day</li>
<li>Subtracting a date/time/timestamp value from another gives an interval value</li>
<li>Interval values can be added to date/time/timestamp values</li>
</ul></li>
</ul>
</section>
<section id="index-creation" class="slide level2">
<h2>Index Creation</h2>
<ul>
<li><div class="sourceCode" id="cb68"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb68-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">table</span> student(<span class="kw">ID</span> <span class="dt">varchar</span>(<span class="dv">5</span>),</span>
<span id="cb68-2"><a aria-hidden="true" tabindex="-1"></a>    name <span class="dt">varchar</span>(<span class="dv">20</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb68-3"><a aria-hidden="true" tabindex="-1"></a>    dept_name <span class="dt">varchar</span>(<span class="dv">20</span>),</span>
<span id="cb68-4"><a aria-hidden="true" tabindex="-1"></a>    tot cred <span class="dt">numeric</span> (<span class="dv">3</span>,<span class="dv">0</span>) <span class="kw">default</span> <span class="dv">0</span>,</span>
<span id="cb68-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">primary</span> <span class="kw">key</span> (<span class="kw">ID</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>create index studentID index on student(ID)</p></li>
<li><p>Indices are data structures used to speed up access to records with specified values for index attributes</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb69-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="op">*</span></span>
<span id="cb69-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> student</span>
<span id="cb69-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="kw">ID</span> <span class="op">=</span> <span class="st">'12345'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Can be executed by using the index to find the required record, without looking at all records of student</li>
</ul></li>
</ul>
</section>
<section id="user-defined-types" class="slide level2">
<h2>User Defined Types</h2>
<ul>
<li><p><strong>create type</strong> construct in SQL creates user-defined type (alias, like typedef in C)</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb70-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">type</span> Dollars <span class="kw">as</span> <span class="dt">numeric</span> (<span class="dv">12</span>,<span class="dv">2</span>) final</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><div class="sourceCode" id="cb71"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb71-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">table</span> department (</span>
<span id="cb71-2"><a aria-hidden="true" tabindex="-1"></a>        dept_name <span class="dt">varchar</span> (<span class="dv">20</span>),</span>
<span id="cb71-3"><a aria-hidden="true" tabindex="-1"></a>        building <span class="dt">varchar</span> (<span class="dv">15</span>),</span>
<span id="cb71-4"><a aria-hidden="true" tabindex="-1"></a>        budget Dollars</span>
<span id="cb71-5"><a aria-hidden="true" tabindex="-1"></a>    );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="domains" class="slide level2">
<h2>Domains</h2>
<ul>
<li><p><strong>create domain</strong> construct in SQL-92 creates user-defined domain types</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb72-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">domain</span> person_name <span class="dt">char</span>(<span class="dv">20</span>) <span class="kw">not</span> <span class="kw">null</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Types and domains are similar</p></li>
<li><p>Domains can have constraints, such as <strong>not null</strong> specified on them</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb73-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">domain</span> degree_level <span class="dt">varchar</span>(<span class="dv">10</span>)</span>
<span id="cb73-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">constraint</span> degree_level_test</span>
<span id="cb73-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">check</span> (<span class="fu">value</span> <span class="kw">in</span> (<span class="st">'Bachelors'</span>, <span class="st">'Masters'</span>, <span class="st">'Doctorate'</span>));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="large-object-types" class="slide level2">
<h2>Large-Object Types</h2>
<ul>
<li>Large objects (photos, videos, CAD files, etc.) are stored as a large object:
<ul>
<li><strong>blob</strong>: binary large object – object is a large collection of uninterpreted binary data (whose interpretation is left to an application outside of the database system)</li>
<li><strong>clob</strong>: character large object – object is a large collection of character data</li>
<li>When a query returns a large object, a pointer is returned rather than the large object itself</li>
</ul></li>
</ul>
</section>
<section id="authorization" class="slide level2">
<h2>Authorization</h2>
<ul>
<li>Forms of authorization on parts of the database:
<ul>
<li><strong>Read</strong> - allows reading, but not modification of data</li>
<li><strong>Insert</strong> - allows insertion of new data, but not modification of existing data</li>
<li><strong>Update</strong> - allows modification, but not deletion of data</li>
<li><strong>Delete</strong> - allows deletion of data</li>
</ul></li>
<li>Forms of authorization to modify the database schema
<ul>
<li><strong>Index</strong> - allows creation and deletion of indices</li>
<li><strong>Resources</strong> - allows creation of new relations</li>
<li><strong>Alteration</strong> - allows addition or deletion of attributes in a relation</li>
<li><strong>Drop</strong> - allows deletion of relations</li>
</ul></li>
</ul>
</section>
<section id="authorization-specification-in-sql" class="slide level2">
<h2>Authorization Specification in SQL</h2>
<ul>
<li><p>The <strong>grant</strong> statement is used to confer authorization</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb74-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">grant</span> <span class="op">&lt;</span><span class="kw">privilege</span> <span class="kw">list</span><span class="op">&gt;</span></span>
<span id="cb74-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">on</span> <span class="op">&lt;</span>relation name <span class="kw">or</span> <span class="kw">view</span> name<span class="op">&gt;</span> <span class="kw">to</span> <span class="op">&lt;</span><span class="fu">user</span> <span class="kw">list</span><span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><span class="math inline">\(\text{&lt;user list&gt;}\)</span> is:</p>
<ul>
<li>a user-id</li>
<li><strong>public</strong>, which allows all valid users the privilege granted</li>
<li>A role (more on this later)</li>
</ul></li>
<li><p>Granting a privilege on a view does not imply granting any privileges on the underlying relations</p></li>
<li><p>The grantor of the privilege must already hold the privilege on the specified item (or be the database administrator)</p></li>
</ul>
</section>
<section id="privileges-in-sql" class="slide level2">
<h2>Privileges in SQL</h2>
<ul>
<li><p><strong>select</strong>: allows read access to relation, or the ability to query using the view</p>
<ul>
<li><p>Example: grant users <span class="math inline">\(U_1\)</span>, <span class="math inline">\(U_2\)</span>, and <span class="math inline">\(U_3\)</span> <strong>select</strong> authorization on the instructor relation:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb75-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">grant</span> <span class="kw">select</span> <span class="kw">on</span> instructor <span class="kw">to</span> U1, U2, U3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
<li><p><strong>insert</strong>: the ability to insert tuples</p></li>
<li><p><strong>update</strong>: the ability to update tuples</p></li>
<li><p><strong>delete</strong>: the ability to delete tuples</p></li>
<li><p><strong>all privileges</strong>: used as a short form for all the allowable privileges</p></li>
</ul>
</section>
<section id="revoking-authorization-in-sql" class="slide level2">
<h2>Revoking Authorization in SQL</h2>
<ul>
<li><p>The <strong>revoke</strong> statement is used to revoke authorization</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb76-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">revoke</span> <span class="op">&lt;</span><span class="kw">privilege</span> <span class="kw">list</span><span class="op">&gt;</span></span>
<span id="cb76-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">on</span> <span class="op">&lt;</span>relation name <span class="kw">or</span> <span class="kw">view</span> name<span class="op">&gt;</span> <span class="kw">from</span> <span class="op">&lt;</span><span class="fu">user</span> <span class="kw">list</span><span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Example:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb77-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">revoke</span> <span class="kw">select</span> <span class="kw">on</span> branch <span class="kw">from</span> U1, U2, U3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><span class="math inline">\(\text{&lt;privilege-list&gt;}\)</span> may be <em>all</em> to revoke all privileges the revokee may hold</p></li>
<li><p>If <span class="math inline">\(\text{&lt;revokee-list&gt;}\)</span> includes <em>public</em>, all users lose the privilege except those granted it explicitly</p></li>
<li><p>If the same privilege was granted twice to the same user by different grantees, the user may retain the privilege after the revocation</p></li>
<li><p>All privileges that depend on the privilege being revoked are also revoked</p></li>
</ul>
</section>
<section id="roles" class="slide level2">
<h2>Roles</h2>
<ul>
<li><div class="sourceCode" id="cb78"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb78-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">role</span> instructor;</span>
<span id="cb78-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">grant</span> instructor <span class="kw">to</span> Amit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Privileges can be granted to roles:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb79-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">grant</span> <span class="kw">select</span> <span class="kw">on</span> takes <span class="kw">to</span> instructor;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Roles can be granted to users, as well as to other roles</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb80-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">role</span> teaching_assistant;</span>
<span id="cb80-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">grant</span> teaching_assistant <span class="kw">to</span> instructor;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Instructor inherits all privileges of teaching_assistant</li>
</ul></li>
<li><p>Chain of roles</p>
<ul>
<li><strong>create role</strong> dean;</li>
<li><strong>grant</strong> instructor <strong>to</strong> dean;</li>
<li><strong>grant</strong> dean <strong>to</strong> Satoshi;</li>
</ul></li>
</ul>
</section>
<section id="authorization-on-views" class="slide level2">
<h2>Authorization on Views</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb81-1"><a aria-hidden="true" tabindex="-1"></a>   <span class="kw">create</span> <span class="kw">view</span> geo_instructor <span class="kw">as</span></span>
<span id="cb81-2"><a aria-hidden="true" tabindex="-1"></a>   (<span class="kw">select</span> <span class="op">*</span></span>
<span id="cb81-3"><a aria-hidden="true" tabindex="-1"></a>     <span class="kw">from</span> instructor</span>
<span id="cb81-4"><a aria-hidden="true" tabindex="-1"></a>     <span class="kw">where</span> dept_name <span class="op">=</span> ’Geology’);</span>
<span id="cb81-5"><a aria-hidden="true" tabindex="-1"></a>     <span class="kw">grant</span> <span class="kw">select</span> <span class="kw">on</span> geo_instructor <span class="kw">to</span> geo_staff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Suppose that a geo_staff member issues</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb82-1"><a aria-hidden="true" tabindex="-1"></a>   <span class="kw">select</span> <span class="op">*</span></span>
<span id="cb82-2"><a aria-hidden="true" tabindex="-1"></a>   <span class="kw">from</span> geo_instructor;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>What if
<ul>
<li>geo_staff does not have permissions on instructor?</li>
<li>creator of view did not have some permissions on instructor?</li>
</ul></li>
</ul>
</section>
<section id="other-authorization-features" class="slide level2">
<h2>Other Authorization Features</h2>
<ul>
<li><p><strong>references</strong> privilege to create foreign key</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb83-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">grant</span> reference (dept_name) <span class="kw">on</span> department <span class="kw">to</span> Mariano;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>why is this required?</li>
</ul></li>
<li><p>Transfer of privileges</p>
<ul>
<li><strong>grant select on</strong> department <strong>to</strong> Amit <strong>with grant option</strong>;</li>
<li><strong>revoke select on</strong> department <strong>from</strong> Amit, Satoshi <strong>cascade</strong>;</li>
<li><strong>revoke select on</strong> department <strong>from</strong> Amit, Satoshi <strong>restrict</strong>;</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="lecture-3.5-advanced-sql" class="title-slide slide level1 center">
<h1>Lecture 3.5: Advanced SQL</h1>

</section>
<section id="native-language-query-language" class="slide level2">
<h2>Native Language ← → Query Language</h2>

<img data-src="aaa.svg" class="r-stretch"></section>
<section id="functions-and-procedures" class="slide level2">
<h2>Functions and Procedures</h2>
<ul>
<li>Functions / Procedures and Control Flow Statements were added in SQL:1999
<ul>
<li>Functions/Procedures can be written in SQL itself, or in an external programming language (like C, Java)</li>
<li>Functions written in an external languages are particularly useful with specialized data types such as images and geometric objects
<ul>
<li>Example: Functions to check if polygons overlap, or to compare images for similarity</li>
</ul></li>
<li>Some database systems support table-valued functions, which can return a relation as a result</li>
</ul></li>
<li>SQL:1999 also supports a rich set of imperative constructs, including loops, if-then-else, and assignment</li>
<li>Many databases have proprietary procedural extensions to SQL that differ from SQL:1999</li>
</ul>
</section>
<section id="sql-functions" class="slide level2">
<h2>SQL Functions</h2>
<ul>
<li><p>Define a function that, given the name of a department, returns the count of the number of instructors in that department:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb84-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">function</span> dept_count (dept name <span class="dt">varchar</span>(<span class="dv">20</span>))</span>
<span id="cb84-2"><a aria-hidden="true" tabindex="-1"></a>        returns <span class="dt">integer</span></span>
<span id="cb84-3"><a aria-hidden="true" tabindex="-1"></a>        <span class="cf">begin</span></span>
<span id="cb84-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">declare</span> d_count <span class="dt">integer</span>;</span>
<span id="cb84-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">select</span> <span class="fu">count</span> (<span class="op">*</span>) <span class="kw">into</span> d_count</span>
<span id="cb84-6"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">from</span> instructor</span>
<span id="cb84-7"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">where</span> instructor.dept_name <span class="op">=</span> dept_name</span>
<span id="cb84-8"><a aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> d_cont;</span>
<span id="cb84-9"><a aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>The function dept count can be used to find the department names and budget of all departments with more that 12 instructors:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb85-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> dept_name, budget</span>
<span id="cb85-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> department</span>
<span id="cb85-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> dept_count (dept_name ) <span class="op">&gt;</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="sql-functions-2" class="slide level2">
<h2>SQL Functions (2)</h2>
<ul>
<li><p>Compound statement: <strong>begin . . . end</strong> May contain multiple SQL statements between begin and end.</p></li>
<li><p><strong>returns</strong> – indicates the variable-type that is returned (for example, integer)</p></li>
<li><p><strong>return</strong> – specifies the values that are to be returned as result of invoking the function</p></li>
<li><p>SQL function are in fact <em>parameterized views</em> that generalize the regular notion of views by allowing parameters</p></li>
</ul>
</section>
<section id="table-functions" class="slide level2">
<h2>Table Functions</h2>
<ul>
<li><p>Functions that return a relation as a result added in SQL:2003</p></li>
<li><p>Return all instructors in a given department:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb86-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">function</span> instructor_of (dept_name <span class="dt">char</span>(<span class="dv">20</span>))</span>
<span id="cb86-2"><a aria-hidden="true" tabindex="-1"></a>    returns <span class="kw">table</span> (</span>
<span id="cb86-3"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">ID</span> <span class="dt">varchar</span>(<span class="dv">5</span>),</span>
<span id="cb86-4"><a aria-hidden="true" tabindex="-1"></a>      name <span class="dt">varchar</span>(<span class="dv">20</span>),</span>
<span id="cb86-5"><a aria-hidden="true" tabindex="-1"></a>      dept_name <span class="dt">varchar</span>(<span class="dv">20</span>)</span>
<span id="cb86-6"><a aria-hidden="true" tabindex="-1"></a>      salary <span class="dt">numeric</span>(<span class="dv">8</span>, <span class="dv">2</span>) )</span>
<span id="cb86-7"><a aria-hidden="true" tabindex="-1"></a>    returns <span class="kw">table</span></span>
<span id="cb86-8"><a aria-hidden="true" tabindex="-1"></a>      (<span class="kw">select</span> <span class="kw">ID</span>, name, dept_name, salary</span>
<span id="cb86-9"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">from</span> instructor</span>
<span id="cb86-10"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">where</span> instructor.dept_name <span class="op">=</span> instructor_of.dept_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Usage</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb87-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="op">*</span></span>
<span id="cb87-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> <span class="kw">table</span> (instructor_of (‘Music’))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="sql-procedures" class="slide level2">
<h2>SQL Procedures</h2>
<ul>
<li><p>The dept count function could instead be written as procedure:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb88-1"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">create</span> <span class="kw">procedure</span> dept_count_proc (</span>
<span id="cb88-2"><a aria-hidden="true" tabindex="-1"></a>          <span class="kw">in</span> dept_name <span class="dt">varchar</span> (<span class="dv">20</span>), <span class="kw">out</span> d_count <span class="dt">integer</span>)</span>
<span id="cb88-3"><a aria-hidden="true" tabindex="-1"></a>          <span class="cf">begin</span></span>
<span id="cb88-4"><a aria-hidden="true" tabindex="-1"></a>              <span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">into</span> d_count</span>
<span id="cb88-5"><a aria-hidden="true" tabindex="-1"></a>              <span class="kw">from</span> instructor</span>
<span id="cb88-6"><a aria-hidden="true" tabindex="-1"></a>              <span class="kw">where</span> instructor.dept_name <span class="op">=</span> dept_count_proc.dept_name</span>
<span id="cb88-7"><a aria-hidden="true" tabindex="-1"></a>          <span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Procedures can be invoked either from an SQL procedure or from embedded SQL, using the <strong>call</strong> statement.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb89-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span> d_count <span class="dt">integer</span>;</span>
<span id="cb89-2"><a aria-hidden="true" tabindex="-1"></a><span class="kw">call</span> dept_count_proc(‘Physics’, d_count);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Procedures and functions can be invoked also from dynamic SQL</p></li>
<li><p>SQL:1999 allows <strong>overloading</strong> - more than one function/procedure of the same name as long as the number of arguments and/or the types of the arguments differ</p></li>
</ul>
</section>
<section id="language-constructs-for-procedures-and-functions" class="slide level2">
<h2>Language Constructs for Procedures and Functions</h2>
<ul>
<li>SQL supports constructs that gives it almost all the power of a general-purpose programming language.
<ul>
<li>Warning: <strong>Most database systems implement their own variant of the standard syntax</strong></li>
</ul></li>
<li>Compound statements: <strong>begin . . . end</strong>
<ul>
<li>May contain multiple SQL statements between <strong>begin</strong> and <strong>end</strong></li>
<li>Local variables can be declared within a compound statement</li>
</ul></li>
</ul>
</section>
<section id="language-constructs-2-while-and-repeat" class="slide level2">
<h2>Language Constructs (2): while and repeat</h2>
<ul>
<li><p><strong>while</strong> loop</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb90-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> boolean_expression do</span>
<span id="cb90-2"><a aria-hidden="true" tabindex="-1"></a>        sequence_of_statements;</span>
<span id="cb90-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">while</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>repeat</strong> loop</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb91-1"><a aria-hidden="true" tabindex="-1"></a>    repeat</span>
<span id="cb91-2"><a aria-hidden="true" tabindex="-1"></a>        sequence_of_statements;</span>
<span id="cb91-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">until</span> boolean_expression;</span>
<span id="cb91-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> repeat;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="language-constructs-3-for" class="slide level2">
<h2>Language Constructs (3): for</h2>
<ul>
<li><p><strong>for</strong> loop</p>
<ul>
<li>Permits iteration over all results of a query</li>
</ul></li>
<li><p>Find the budget if all departments:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb92-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">declare</span> n <span class="dt">integer</span> <span class="kw">default</span> <span class="dv">0</span>;</span>
<span id="cb92-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> r <span class="kw">as</span></span>
<span id="cb92-3"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">select</span> budget <span class="kw">from</span> department</span>
<span id="cb92-4"><a aria-hidden="true" tabindex="-1"></a>    do</span>
<span id="cb92-5"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">set</span> n <span class="op">=</span> n <span class="op">+</span> r.budget</span>
<span id="cb92-6"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">for</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="language-constructs-4-if-then-else" class="slide level2">
<h2>Language Constructs (4): if-then-else</h2>
<ul>
<li><p>Conditional statements</p>
<ul>
<li><strong>if</strong>-<strong>then</strong>-<strong>else</strong></li>
<li><strong>case</strong></li>
</ul></li>
<li><p><strong>if</strong>-<strong>then</strong>-<strong>else</strong> statement</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb93-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> boolean_expression <span class="cf">then</span></span>
<span id="cb93-2"><a aria-hidden="true" tabindex="-1"></a>        sequence_of_statements;</span>
<span id="cb93-3"><a aria-hidden="true" tabindex="-1"></a>    elseif boolean_expression <span class="cf">then</span></span>
<span id="cb93-4"><a aria-hidden="true" tabindex="-1"></a>        sequence_of_statements;</span>
<span id="cb93-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="op">..</span>.</span>
<span id="cb93-6"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb93-7"><a aria-hidden="true" tabindex="-1"></a>        sequence_of_statements;</span>
<span id="cb93-8"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">if</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>The <strong>if</strong> statement supports the use of optional <strong>elseif</strong> clauses and a default <strong>else</strong> clause</p></li>
<li><p>Example procedure: registers student after ensuring that classroom capacity is not exceeded</p>
<ul>
<li>Returns 0 on success and -1 if capacity is exceeded</li>
</ul></li>
</ul>
</section>
<section id="language-constructs-5-simple-case" class="slide level2">
<h2>Language Constructs (5): Simple case</h2>
<ul>
<li><p>Simple <strong>case</strong> statement</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb94-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> variable</span>
<span id="cb94-2"><a aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> value1 <span class="cf">then</span></span>
<span id="cb94-3"><a aria-hidden="true" tabindex="-1"></a>            sequence_of_statements;</span>
<span id="cb94-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> value2 <span class="cf">then</span></span>
<span id="cb94-5"><a aria-hidden="true" tabindex="-1"></a>            sequence_of_statements;</span>
<span id="cb94-6"><a aria-hidden="true" tabindex="-1"></a>        <span class="op">..</span>.</span>
<span id="cb94-7"><a aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb94-8"><a aria-hidden="true" tabindex="-1"></a>            sequence_of_statements;</span>
<span id="cb94-9"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">case</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>The <strong>when</strong> clause of the <strong>case</strong> statement defines the value that when satisfied determines the flow of control</p></li>
</ul>
</section>
<section id="language-constructs-6-searched-case" class="slide level2">
<h2>Language Constructs (6): Searched case</h2>
<ul>
<li><p>Searched <strong>case</strong> statements</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb95-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span></span>
<span id="cb95-2"><a aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> sql_expression <span class="op">=</span> value1 <span class="cf">then</span></span>
<span id="cb95-3"><a aria-hidden="true" tabindex="-1"></a>            sequence_of_statements;</span>
<span id="cb95-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> sql_expression <span class="op">=</span> value2 <span class="cf">then</span></span>
<span id="cb95-5"><a aria-hidden="true" tabindex="-1"></a>            sequence_of_statements;</span>
<span id="cb95-6"><a aria-hidden="true" tabindex="-1"></a>        <span class="op">..</span>.</span>
<span id="cb95-7"><a aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb95-8"><a aria-hidden="true" tabindex="-1"></a>            sequence_of_statements;</span>
<span id="cb95-9"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">case</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Any supported SQL expression can be used here. These expressions can contain references to variables, parameters, special registers, and more.</p></li>
</ul>
</section>
<section id="language-constructs-7-exception" class="slide level2">
<h2>Language Constructs (7): Exception</h2>
<ul>
<li><p>Signaling of exception conditions, and declaring handlers for exceptions</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb96-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">declare</span> out_of_classroom_seats condition</span>
<span id="cb96-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">declare</span> exit handler <span class="cf">for</span> out_of_classroom_seats</span>
<span id="cb96-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">begin</span></span>
<span id="cb96-4"><a aria-hidden="true" tabindex="-1"></a>        <span class="op">..</span>.</span>
<span id="cb96-5"><a aria-hidden="true" tabindex="-1"></a>        signal out_of_classroom_seats</span>
<span id="cb96-6"><a aria-hidden="true" tabindex="-1"></a>        <span class="op">..</span>.</span>
<span id="cb96-7"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The handler here is <strong>exit</strong> – causes enclosing <strong>begin . . . end</strong> to be terminate and exit</li>
<li>Other actions possible on exception</li>
</ul></li>
</ul>
</section>
<section id="external-language-routines" class="slide level2">
<h2>External Language Routines*</h2>
<ul>
<li><p>SQL:1999 allows the definition of functions and procedures in an external / imperative programming language, (Java, C#, C, or C++) which can be invoked from SQL queries</p></li>
<li><p>Such functions can be more efficient than functions defined in SQL, and computations that cannot be carried out in SQL can be executed by these functions</p></li>
<li><p>Declaring external language procedures and functions</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb97-1"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">procedure</span> dept_count_proc(</span>
<span id="cb97-2"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">in</span> dept_name <span class="dt">varchar</span>(<span class="dv">20</span>),</span>
<span id="cb97-3"><a aria-hidden="true" tabindex="-1"></a>            <span class="kw">out</span> <span class="fu">count</span> <span class="dt">integer</span>)</span>
<span id="cb97-4"><a aria-hidden="true" tabindex="-1"></a>        language C</span>
<span id="cb97-5"><a aria-hidden="true" tabindex="-1"></a>        external name ’<span class="op">/</span>usr<span class="op">/</span>avi<span class="op">/</span>bin<span class="op">/</span>dept_count_proc’</span>
<span id="cb97-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a aria-hidden="true" tabindex="-1"></a>    <span class="kw">create</span> <span class="kw">function</span> dept_count(dept_name <span class="dt">varchar</span>(<span class="dv">20</span>))</span>
<span id="cb97-8"><a aria-hidden="true" tabindex="-1"></a>    returns <span class="dt">integer</span></span>
<span id="cb97-9"><a aria-hidden="true" tabindex="-1"></a>        language C</span>
<span id="cb97-10"><a aria-hidden="true" tabindex="-1"></a>        external name ‘<span class="op">/</span>usr<span class="op">/</span>avi<span class="op">/</span>bin<span class="op">/</span>dept_count’</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="external-language-routines-2" class="slide level2">
<h2>External Language Routines (2)*</h2>
<ul>
<li>Benefits of external language functions/procedures:
<ul>
<li>More efficient for many operations, and more expressive power</li>
</ul></li>
<li>Drawbacks
<ul>
<li>Code to implement function may need to be loaded into database system and executed in the database system’s address space
<ul>
<li>Risk of accidental corruption of database structures</li>
<li>Security risk, allowing users access to unauthorized data</li>
</ul></li>
<li>There are alternatives, which give good security at the cost of performance</li>
<li>Direct execution in the database system’s space is used when efficiency is more important than security</li>
</ul></li>
</ul>
</section>
<section id="external-language-routines-3-security" class="slide level2">
<h2>External Language Routines (3)*: Security</h2>
<ul>
<li>To deal with security problems, we can do one of the following:
<ul>
<li>Use <strong>sandbox</strong> techniques
<ul>
<li>That is, use a safe language like Java, which cannot be used to access/damage other parts of the database code</li>
</ul></li>
<li>Run external language functions/procedures in a separate process, with no access to the database process’ memory
<ul>
<li>Parameters and results communicated via inter-process communication</li>
</ul></li>
</ul></li>
<li>Both have performance overheads</li>
<li>Many database systems support both above approaches as well as direct executing in database system address space</li>
</ul>
</section>
<section id="trigger" class="slide level2">
<h2>Trigger</h2>
<ul>
<li>A <strong>trigger</strong> defines a set of actions that are performed in response to an <strong>insert</strong>, <strong>update</strong>, or <strong>delete</strong> operation on a specified table
<ul>
<li>When such an SQL operation is executed, the trigger is said to have been <strong>activated</strong></li>
<li>Triggers are <strong>optional</strong></li>
<li>Triggers are defined using the <strong>create trigger</strong> statement</li>
</ul></li>
<li>Triggers can be used
<ul>
<li>To enforce data integrity rules via referential constraints and check constraints</li>
<li>To cause updates to other tables, automatically generate or transform values for inserted or updated rows, or invoke functions to perform tasks such as issuing alerts</li>
</ul></li>
<li>To design a trigger mechanism, we must:
<ul>
<li>Specify the <strong>events</strong> / (like <strong>update</strong>, <strong>insert</strong>, or <strong>delete</strong>) for the trigger to executed</li>
<li>Specify the <strong>time</strong> (<strong>BEFORE</strong> or <strong>AFTER</strong>) of execution</li>
<li>Specify the <strong>actions</strong> to be taken when the trigger executes</li>
</ul></li>
<li><strong>Syntax of triggers may vary across systems</strong></li>
</ul>
</section>
<section id="types-of-triggers-before" class="slide level2">
<h2>Types of Triggers: BEFORE</h2>
<ul>
<li><strong>BEFORE triggers</strong>
<ul>
<li>Run before an <strong>update</strong>, or <strong>insert</strong></li>
<li>Values that are being updated or inserted can be modified before the database is actually modified. You can use triggers that run before an update or insert to:
<ul>
<li>Check or modify values before they are actually updated or inserted in the database
<ul>
<li>Useful if user-view and internal database format differs</li>
</ul></li>
<li>Run other non-database operations coded in user-defined functions</li>
</ul></li>
</ul></li>
<li><strong>BEFORE DELETE triggers</strong>
<ul>
<li>Run before a <strong>delete</strong>
<ul>
<li>Checks values (a raises an error, if necessary)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="types-of-triggers-2-after" class="slide level2">
<h2>Types of Triggers (2): AFTER</h2>
<ul>
<li><strong>AFTER triggers</strong>
<ul>
<li>Run before an <strong>update</strong>, <strong>insert</strong>, or <strong>delete</strong></li>
<li>You can use triggers that run after an update or insert to:
<ul>
<li>Update data in other tables
<ul>
<li>Useful for maintain relationships between data or keep audit trail</li>
</ul></li>
<li>Check against other data in the table or in other tables
<ul>
<li>Useful to ensure data integrity when referential integrity constraints aren’t appropriate, or</li>
<li>when table check constraints limit checking to the current table only</li>
</ul></li>
<li>Run non-database operations coded in user-defined functions
<ul>
<li>Useful when issuing alerts or to update information outside the database</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="row-level-and-statement-level-triggers" class="slide level2">
<h2>Row Level and Statement Level Triggers</h2>
<p>There are two types of triggers based on the level at which the triggers are applied:</p>
<ul>
<li><strong>Row level triggers</strong> are executed whenever a row is affected by the event on which the trigger is defined.
<ul>
<li>Let Employee be a table with 100 rows. Suppose an <strong>update</strong> statement is executed to increase the salary of each employee by 10%. Any row level <strong>update</strong> trigger configured on the table Employee will affect all the 100 rows in the table during this update.</li>
</ul></li>
<li><strong>Statement level triggers</strong> perform a single action for all rows affected by a statement, instead of executing a separate action for each affected row.
<ul>
<li>Used for each <strong>statement</strong> instead of for each <strong>row</strong></li>
<li>Uses <strong>referencing old table</strong> or <strong>referencing new table</strong> to refer to temporary tables called <strong>transition tables</strong> containing the affected rows</li>
<li>Can be more efficient when dealing with SQL statements that update a large number of rows</li>
</ul></li>
</ul>
</section>
<section id="triggering-events-and-actions-in-sql" class="slide level2">
<h2>Triggering Events and Actions in SQL</h2>
<ul>
<li><p>Triggering event can be an insert, delete or update</p></li>
<li><p>Triggers on update can be restricted to specific attributes</p>
<ul>
<li>For example, <strong>after update of</strong> <em>grade</em> <strong>on</strong> <em>takes</em></li>
</ul></li>
<li><p>Values of attributes before and after an update can be referenced</p>
<ul>
<li><strong>referencing old row as</strong> : for deletes and updates</li>
<li><strong>referencing new row as</strong> : for inserts and updates</li>
</ul></li>
<li><p>Triggers can be activated before an event, which can serve as extra constraints. For example, convert blank grades to null.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb98-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">trigger</span> setnull_trigger <span class="kw">before</span> <span class="kw">update</span> <span class="kw">of</span> takes</span>
<span id="cb98-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">referencing</span> <span class="kw">new</span> <span class="kw">row</span> <span class="kw">as</span> nrow</span>
<span id="cb98-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="kw">each</span> <span class="kw">row</span></span>
<span id="cb98-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="cf">when</span> (nrow.grade <span class="op">=</span> ‘ ‘)</span>
<span id="cb98-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">begin</span> atomic</span>
<span id="cb98-6"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">set</span> nrow.grade <span class="op">=</span> <span class="kw">null</span>;</span>
<span id="cb98-7"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="triggering-to-maintain-credits_earned-value" class="slide level2">
<h2>Triggering to Maintain credits_earned value</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb99-1"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">trigger</span> credits_earned <span class="kw">after</span> <span class="kw">update</span> <span class="kw">of</span> grade <span class="kw">on</span> takes</span>
<span id="cb99-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">referencing</span> <span class="kw">new</span> <span class="kw">row</span> <span class="kw">as</span> nrow</span>
<span id="cb99-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="kw">referencing</span> <span class="kw">old</span> <span class="kw">row</span> <span class="kw">as</span> orow</span>
<span id="cb99-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="kw">each</span> <span class="kw">row</span></span>
<span id="cb99-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="cf">when</span> nrow.grade <span class="op">&lt;&gt;</span> <span class="st">'F'</span> <span class="kw">and</span> nrow.grade <span class="kw">is</span> <span class="kw">not</span> <span class="kw">null</span> <span class="kw">and</span></span>
<span id="cb99-6"><a aria-hidden="true" tabindex="-1"></a>       (orow.grade <span class="op">=</span> <span class="st">'F'</span> <span class="kw">or</span> orow.grade <span class="kw">is</span> <span class="kw">null</span>)</span>
<span id="cb99-7"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">begin</span> atomic</span>
<span id="cb99-8"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">update</span> student</span>
<span id="cb99-9"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">set</span> tot_cred <span class="op">=</span> tot_cred <span class="op">+</span> </span>
<span id="cb99-10"><a aria-hidden="true" tabindex="-1"></a>          (<span class="kw">select</span> credits</span>
<span id="cb99-11"><a aria-hidden="true" tabindex="-1"></a>          <span class="kw">from</span> course</span>
<span id="cb99-12"><a aria-hidden="true" tabindex="-1"></a>          <span class="kw">where</span> course.course_id <span class="op">=</span> nrow.course_id)</span>
<span id="cb99-13"><a aria-hidden="true" tabindex="-1"></a>      <span class="kw">where</span> student.<span class="kw">ID</span> <span class="op">=</span> nrow.<span class="kw">ID</span>;</span>
<span id="cb99-14"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="how-to-use-triggers" class="slide level2">
<h2>How to use triggers?</h2>
<ul>
<li><p>The optimal use of DML triggers is for short, simple, and easy to maintain write operations that act largely independent of an applications business logic.</p></li>
<li><p>Typical and recommended uses of triggers include:</p>
<ul>
<li><em>Logging changes</em> to a history table</li>
<li><em>Auditing users and their actions</em> against sensitive tables</li>
<li><em>Adding additional values to a table</em> that may not be available to an application (due to security restrictions or other limitations), such as:
<ul>
<li>Login/user name</li>
<li>Time an operation occurs</li>
<li>Server/database name</li>
</ul></li>
<li>Simple validation</li>
</ul></li>
</ul>
</section>
<section id="how-not-to-use-triggers" class="slide level2">
<h2>How not to use triggers?</h2>
<ul>
<li>Triggers are like Lays: Once you pop, you can’t stop</li>
<li>One of the greatest challenges for architects and developers is to ensure that
<ul>
<li>triggers are used only as needed, and</li>
<li>to not allow them to become a one-size-fits-all solution for any data needs that happen to come along</li>
</ul></li>
<li>Adding triggers is often seen as faster and easier than adding code to an application, but the cost of doing so is compounded over time with each added line of code</li>
</ul>
</section>
<section id="how-to-use-triggers-2" class="slide level2">
<h2>How to use triggers? (2)</h2>
<ul>
<li>Triggers can become dangerous when:
<ul>
<li>There are too many</li>
<li>Trigger code becomes complex</li>
<li>Triggers go cross-server - across databases over network</li>
<li>Triggers call triggers</li>
<li>Recursive triggers are set to ON. This database-level setting is set to off by default</li>
<li>Functions, stored procedures, or views are in triggers</li>
<li>Iteration occurs</li>
</ul></li>
</ul>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="../../pages/DBMS/w3.html">Complete notes</a></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>